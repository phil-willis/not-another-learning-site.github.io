<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="Not another learning site."/><meta property="og:image" content="https://og-image.now.sh/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>Not another learning site.</title><meta property="og:image" content="/assets/covers/_blank_.jpg"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/d8d6bd39d8240bb4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d8d6bd39d8240bb4.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cf121497002c184d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cf121497002c184d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-779b41245c009d2a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-156acf25c3b6001c.js" defer=""></script><script src="/_next/static/chunks/664-4243e6d8b13d56da.js" defer=""></script><script src="/_next/static/chunks/pages/learn/%5Bslug%5D-f7c40571bdb12048.js" defer=""></script><script src="/_next/static/dWSqlyL7gXbmQPbidqy9q/_buildManifest.js" defer=""></script><script src="/_next/static/dWSqlyL7gXbmQPbidqy9q/_ssgManifest.js" defer=""></script><script src="/_next/static/dWSqlyL7gXbmQPbidqy9q/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="min-h-screen"><main><div class="container mx-auto px-5"><div style="position:fixed;background-color:rgba(255,255,255,0.9);backdrop-filter:blur(10px);width:100%;left:0px;z-index:1000"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8" style="padding:0;padding-left:10px;margin-bottom:20px"><a class="hover:underline" href="/">Learn</a>.</h2></div><article class="mb-32"><div style="height:100px"></div><h1 class="text-6xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">nestjs</h1><div class="mb-8 md:mb-16 sm:mx-0"><div class="sm:mx-0"><img src="/assets/covers/_blank_.jpg" alt="Cover Image for nestjs" class="shadow-sm" layout="responsive" width="1240" height="620"/></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><div>TODO: add language chip here</div></div></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__h_8de"><h1>Nest.js</h1>
<ul>
<li>Not to be confused with <code>Next.js</code></li>
<li>Nestjs is a nodejs framework for building server-side applications</li>
<li>Under the hood, Nest makes use of robust HTTP Server frameworks like Express (the default) and optionally can be configured to use Fastify as well!</li>
<li>It is somewhat opinionated and forces us to follow its vision of how an application should look like to some extent.</li>
<li>Concepts like: Controllers, Providers, Modules, Middleware, Pipes, Guards keeps you in a structed code base which in the JS world might be a breath of fresh air.</li>
<li>Check out the official docs <a href="https://docs.nestjs.com/">here</a></li>
</ul>
<h1>Getting started</h1>
<ul>
<li>Install and use the Nest CLI
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">npm</span> i -g @nestjs/cli
$ nest new project-name
</code></pre></div>
</li>
<li>Alternatively you can clone the starter repo
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">git</span> clone https://github.com/nestjs/typescript-starter.git project
$ <span class="token builtin class-name">cd</span> project
$ <span class="token function">npm</span> <span class="token function">install</span>
$ <span class="token function">npm</span> run start
</code></pre></div>
</li>
<li>You can also just update your package.json to have:
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">"new"</span><span class="token operator">:</span> <span class="token string">"nest generate resource"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>Being opinionated, you're gonna want to structure your routes with controller/service potentially models &#x26; stores</li>
<li>Update the linting</li>
</ul>
<ol>
<li>Install some packages
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># Linting packages</span>
$ <span class="token function">yarn</span> <span class="token function">add</span> -D @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint-config-prettier eslint-plugin-prettier prettier @trivago/prettier-plugin-sort-imports

$ <span class="token function">mkdir</span> .vscode
$ <span class="token function">touch</span> .vscode/settings.json .prettierrc .eslintrc 
</code></pre></div>
</li>
<li>Update the <code>.eslint.js</code> file
<div class="remark-highlight"><pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span>
<span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">project</span><span class="token operator">:</span> <span class="token string">'tsconfig.json'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">tsconfigRootDir</span><span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
    <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">'module'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@typescript-eslint/eslint-plugin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:@typescript-eslint/recommended'</span><span class="token punctuation">,</span> <span class="token string">'plugin:prettier/recommended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token literal-property property">env</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">node</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">jest</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">ignorePatterns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.eslintrc.js'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>Add to the <code>./.prettierrc</code> file</li>
</ol>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"semi"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">"trailingComma"</span><span class="token operator">:</span> <span class="token string">"all"</span><span class="token punctuation">,</span>
  <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"printWidth"</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token property">"importOrder"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"^@core/(.*)$"</span><span class="token punctuation">,</span> <span class="token string">"^@server/(.*)$"</span><span class="token punctuation">,</span> <span class="token string">"^@ui/(.*)$"</span><span class="token punctuation">,</span> <span class="token string">"^[./]"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"importOrderSeparation"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ol start="4">
<li>Add to the <code>./.vscode/settings.json</code> file</li>
</ol>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token comment">// Set prettier to be the default formatter</span>
  <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span><span class="token punctuation">,</span>

  <span class="token comment">// Don't format any files by default</span>
  <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  
  <span class="token property">"[json]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span><span class="token punctuation">,</span>
    <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// JavaScript stuff</span>
  <span class="token property">"[javascript]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span><span class="token punctuation">,</span>
    <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// TypeScript stuff if you need it</span>
  <span class="token property">"[typescript]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span><span class="token punctuation">,</span>
    <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ol start="5">
<li>Add dotenv for the custom port</li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> <span class="token function">add</span> dotenv
</code></pre></div>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/core'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> dotenv <span class="token keyword">from</span> <span class="token string">'dotenv'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app.module'</span>

dotenv<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">⚡ The magic happens at: http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div>
<ol start="6">
<li>Zip the dist folder with only the node_modules needed for the app</li>
</ol>
<ul>
<li>Install a zipper package
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> <span class="token function">add</span> lambda-zipper -D
</code></pre></div>
</li>
<li>Update the <code>package.json</code>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"nest build"</span><span class="token punctuation">,</span>
    <span class="token property">"postbuild"</span><span class="token operator">:</span> <span class="token string">"lambda-zipper build -f dist -o build/app.zip"</span><span class="token punctuation">,</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"node main"</span><span class="token punctuation">,</span>
    <span class="token property">"format"</span><span class="token operator">:</span> <span class="token string">"prettier --write \"src/*.ts\" \"src/**/*.ts\" \"test/**/*.ts\""</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li><strong>NOTE:</strong> make sure you update the <code>start</code> script to <code>"start": "node main"</code> so the build version of the app works</li>
</ul>
<h1>Make your first route</h1>
<ul>
<li>
<p>So the default app is very bare-bones, let's add a component based route</p>
</li>
<li>
<p>Create an entire route resource with one command</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ nest generate resource quotes
$ <span class="token function">yarn</span> lint
</code></pre></div>
</li>
<li>
<p>(or) Create the controller/service/module with the CLI</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ nest generate controller quotes
$ nest generate module quotes
$ nest generate <span class="token function">service</span> quotes
</code></pre></div>
</li>
<li>
<p>This will create a bunch of files</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">src/quotes
├── dto
│   ├── create-quote.dto.ts
│   └── update-quote.dto.ts
├── entities
│   └── quote.entity.ts
├── quotes.controller.spec.ts
├── quotes.controller.ts
├── quotes.module.ts
├── quotes.service.spec.ts
└── quotes.service.ts
</code></pre></div>
</li>
<li>
<p>NestJS provides a  <code>@Body()</code> decorator that gives us easy access to the body.</p>
</li>
<li>
<p><code>dto</code> stands for Data Transfer Object and it defines the format of the data sent in a request.</p>
</li>
<li>
<p>It can be either an interface or a class</p>
</li>
<li>
<p>Controllers's sole responsibility is to deal with http request/response, as for the <code>service</code>'s responsibility is to deal with business logic. You could also take it a step further and create <code>models</code> or <code>store</code> to deal with querying the database however if you are using a ORM you could probably ignore the <code>store</code> for the DB is agnostic</p>
</li>
<li>
<p>SOILD principles with the goal that makes our software easier to understand/maintain/read</p>
<ul>
<li><strong>S</strong><code>ingle responsibilty</code> principle: a class/module should obly be responsible for a single function</li>
<li><strong>O</strong><code>pen-closed</code> principle: software entities should be open for extension but closed for modification.</li>
<li><strong>L</strong><code>iskov substitution</code> principle: changing one area of our system does not break other parts.</li>
<li><strong>I</strong><code>nterface segregation</code> principle: emphasis on creating smaller and more specific interfaces. No client should be forced to depend on methods it does not use. By putting too many properties in our interfaces, we risk breaking the above rule.</li>
<li><strong>D</strong><code>ependency inversion</code> principle: high-level modules should not depend on the low-level modules. Instead, both of them should depend on abstractions.</li>
</ul>
</li>
</ul>
<!-- https://wanago.io/2020/02/03/applying-solid-principles-to-your-typescript-code/ -->
<h2>Validator</h2>
<ul>
<li>
<p>Leveraging your DTO to do validation by adding some class-decorators. Info <a href="https://www.npmjs.com/package/class-validator">here</a></p>
</li>
<li>
<p><strong>note</strong>: you want to add it as a devDependency to keep the build version of the application at a minimum</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> <span class="token function">add</span> -D class-validator class-transformer
</code></pre></div>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> IsNotEmpty<span class="token punctuation">,</span> Length <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'class-validator'</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateQuoteDto</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// validator</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Length</span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>      <span class="token comment">// validator</span>
  quote<span class="token operator">:</span> <span class="token builtin">string</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Length</span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment">// validator</span>
  author<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>now in the POST code should look like this:</p>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UsePipes</span></span><span class="token punctuation">(</span>ValidationPipe<span class="token punctuation">)</span>       <span class="token comment">// we can add pipes to validate the defined DTO</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createQuoteDto<span class="token operator">:</span> CreateQuoteDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createQuoteDto<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>Now if you try to do a POST in the client and the body doesn't validate Nestjs will send a <code>400</code></p>
</li>
</ul>
<h2>Controller</h2>
<ul>
<li>
<p>Remember that the Controller's job is to deal with http request/response and use the service methods to do all the business logic</p>
</li>
<li>
<p>Also notice that with Nestjs we can leverage decorators for defining HTTP verbs and accessing the POST/PUT bodies</p>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Put<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  UsePipes<span class="token punctuation">,</span>
  ValidationPipe<span class="token punctuation">,</span> <span class="token comment">// Added this package to deal with validation of the DTO</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateQuoteDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/create-quote.dto'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateQuoteDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/update-quote.dto'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> QuotesService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./quotes.service'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'quotes'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuotesController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> quotesService<span class="token operator">:</span> QuotesService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UsePipes</span></span><span class="token punctuation">(</span>ValidationPipe<span class="token punctuation">)</span> <span class="token comment">// Validate the Data Transfer Object</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createQuoteDto<span class="token operator">:</span> CreateQuoteDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createQuoteDto<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Put</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UsePipes</span></span><span class="token punctuation">(</span>ValidationPipe<span class="token punctuation">)</span> <span class="token comment">// Validate the Data Transfer Object</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> updateQuoteDto<span class="token operator">:</span> UpdateQuoteDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">,</span> updateQuoteDto<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Delete</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">remove</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div>
</li>
</ul>
<h2>The Service file</h2>
<ul>
<li>The job of a service is to separate the business logic from controllers, making it cleaner and more comfortable to test.</li>
<li>He's the default service created by the Nestjs command, with some in-memory object storage
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateQuoteDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/create-quote.dto'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateQuoteDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/update-quote.dto'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuotesService</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> lastQuotetId <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">private</span> quotes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">create</span><span class="token punctuation">(</span>createQuoteDto<span class="token operator">:</span> CreateQuoteDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>lastQuotetId
    <span class="token keyword">const</span> newItem <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> <span class="token operator">...</span>createQuoteDto <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> newItem
    <span class="token keyword">return</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> newItem <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>id<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> item <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">update</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> updateQuoteDto<span class="token operator">:</span> UpdateQuoteDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> updateQuoteDto
    <span class="token keyword">return</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> deletedItem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>id<span class="token punctuation">]</span>
    <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotes<span class="token punctuation">[</span>id<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">'Deleted'</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> deletedItem<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
</ul>
<h2>Modules</h2>
<ul>
<li>We use modules to organize our application, so this complete route will be packaged in a module:
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> QuotesController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./quotes.controller'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> QuotesService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./quotes.service'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>QuotesController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>QuotesService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuotesModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>And the module will be added to the <strong>root module</strong>*, <code>./src/app.module.ts</code>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> QuotesModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./quotes/quotes.module'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>QuotesModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div>
</li>
</ul>
<h1>Using <code>ConfigService</code> to deal with environment variables</h1>
<ul>
<li>
<p>Docs <a href="https://docs.nestjs.com/techniques/configuration">here</a></p>
</li>
<li>
<p>In Node.js applications, it's common to use .env files, holding key-value pairs where each key represents a particular value, to represent each environment. Running an app in different environments is then just a matter of swapping in the correct .env file.</p>
</li>
<li>
<p>A good approach for using this technique in Nest is to create a <code>ConfigModule</code> that exposes a <code>ConfigService</code> which loads the appropriate .env file. While you may choose to write such a module yourself, for convenience Nest provides the <code>@nestjs/config</code> package out-of-the box.</p>
</li>
<li>
<p>The <code>@nestjs/config</code> package internally uses <code>dotenv</code>.</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> <span class="token function">add</span> @nestjs/config
</code></pre></div>
</li>
<li>
<p><code>app.module.ts</code></p>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ConfigModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/config'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>ConfigModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>You can specify which <code>.env</code> file to use in the <code>app.module.ts</code></p>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ConfigModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/config'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> QuotesModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./quotes/quotes.module'</span>

<span class="token keyword">const</span> EnvModule <span class="token operator">=</span> ConfigModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  envFilePath<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.env.development'</span><span class="token punctuation">,</span> <span class="token string">'.env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>EnvModule<span class="token punctuation">,</span> QuotesModule<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// The order matters</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

</code></pre></div>
</li>
</ul>
<h1>Add Swagger</h1>
<ul>
<li><code>OpenAPI</code> &#x26; <code>Swagger</code>, we can create a user interface that serves as interactive API documentation for our project.</li>
<li>The <code>OpenAPI</code> is a specification used to describe our API and gives us a way to provide the details of our endpoints.</li>
<li><code>Swagger</code> is a set of tools built around the <code>OpenAPI</code> specification. It allows us to render the OpenAPI specification we wrote in as the API documentation. The thing that makes it so valuable is that it is interactive.</li>
<li>Install some packages:
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> <span class="token function">add</span> @nestjs/swagger swagger-ui-express
</code></pre></div>
</li>
<li>Create a <code>./src/utils/swagger.ts</code> file
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> DocumentBuilder<span class="token punctuation">,</span> SwaggerModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/swagger'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">SetupSwagger</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> swaggerConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocumentBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">'API with NestJS'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string">'API developed throughout the API with NestJS course'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setVersion</span><span class="token punctuation">(</span><span class="token string">'1.0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> document <span class="token operator">=</span> SwaggerModule<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> swaggerConfig<span class="token punctuation">)</span>
  SwaggerModule<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token string">'docs'</span><span class="token punctuation">,</span> app<span class="token punctuation">,</span> document<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>Update your <code>./src/main.ts</code> file to include your Swagger addition</li>
</ul>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> ConfigService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/config'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/core'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app.module'</span>
<span class="token keyword">import</span> SetupSwagger <span class="token keyword">from</span> <span class="token string">'./utils/swagger'</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
  <span class="token keyword">const</span> configService <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ConfigService<span class="token punctuation">)</span>

  <span class="token comment">// Swagger</span>
  <span class="token function">SetupSwagger</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span> <span class="token comment">// This line here to add swagger</span>

  <span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> configService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'PORT'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token number">3000</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">⚡ The magic happens at: http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div>
<ul>
<li>Unfortunately, the specification we’ve defined so far does not contain much detail. So update the <code>./nest-cli.json</code> so that the schema can show up in the Swagger doc, update the <code>compilerOptions.plugins</code> to include nestjs swagger
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@nestjs/swagger"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>"@nestjs/swagger" leverage your DTO objects that you create</li>
<li>You can also group your calls my using the <code>import { ApiTags } from '@nestjs/swagger';</code> in your controllers:
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Controller<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
  Put<span class="token punctuation">,</span>
  Body<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  UsePipes<span class="token punctuation">,</span>
  ValidationPipe<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ApiTags <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/swagger'</span>  <span class="token comment">// Import this</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateQuoteDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/create-quote.dto'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UpdateQuoteDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/update-quote.dto'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> QuotesService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./quotes.service'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'quotes'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiTags</span></span><span class="token punctuation">(</span><span class="token string">'Quotes'</span><span class="token punctuation">)</span>  <span class="token comment">// Add this </span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuotesController</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>You can also describe your endpoints with more details. We can use decorators such as <code>@ApiParam()</code> and <code>@ApiResponse()</code> to provide more details about our endpoints.
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'quotes'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiTags</span></span><span class="token punctuation">(</span><span class="token string">'Quotes'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuotesController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> quotesService<span class="token operator">:</span> QuotesService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ApiParam</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
    required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    description<span class="token operator">:</span> <span class="token string">'Should be an id of a quote that exists in the database'</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quotesService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token operator">+</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
</ul>
<h1>Add a database with Prisma</h1>
<ul>
<li>
<p>With Prisma, we describe our data using a Prisma schema file. It uses its own data modeling language and acts as a single source of truth. This differs from traditional ORMs that provide an object-oriented way of working with the database.</p>
</li>
<li>
<p>Every time we make changes to the schema file, we need to generate the Prisma client. In this process, Prisma parses our schema and creates a client along with all the TypeScript typings. This means that we no don't map SQL tables to model classes through the TypeScript code manually.</p>
</li>
<li>
<p>Let's use Docker to deal with the database</p>
<div class="remark-highlight"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3"</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">postgres</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> nestjs<span class="token punctuation">-</span>postgres
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span>latest
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"5432:5432"</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./volumes/postgres<span class="token punctuation">:</span>/data/postgres
    <span class="token key atrule">env_file</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> docker.env
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> postgres

  <span class="token key atrule">pgadmin</span><span class="token punctuation">:</span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> postgres<span class="token punctuation">:</span>postgres
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> nestjs<span class="token punctuation">-</span>pgadmin
    <span class="token key atrule">image</span><span class="token punctuation">:</span> dpage/pgadmin4
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8080:80"</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./volumes/pgadmin<span class="token punctuation">:</span>/root/.pgadmin
    <span class="token key atrule">env_file</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> docker.env
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> postgres

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">postgres</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
</code></pre></div>
</li>
<li>
<p>Create a <code>docker.env</code> file to deal with the postgres configs</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">POSTGRES_USER</span><span class="token operator">=</span>admin
<span class="token assign-left variable">POSTGRES_PASSWORD</span><span class="token operator">=</span>admin
<span class="token assign-left variable">POSTGRES_DB</span><span class="token operator">=</span>nestjs
<span class="token assign-left variable">PGADMIN_DEFAULT_EMAIL</span><span class="token operator">=</span>admin@admin.com
<span class="token assign-left variable">PGADMIN_DEFAULT_PASSWORD</span><span class="token operator">=</span>admin
</code></pre></div>
</li>
<li>
<p>Install prisma</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> <span class="token function">add</span> prisma @prisma/client
$ npx prisma init
</code></pre></div>
</li>
<li>
<p>Prisma will create a <code>./prisma/schema.prisma</code> &#x26; add the database url to the <code>.env</code> file.</p>
</li>
<li>
<p>Update the <code>.env</code> to use the database url we're gonna use with docker-compose postgres service</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">DATABASE_URL</span><span class="token operator">=</span><span class="token string">"postgresql://admin:admin@localhost:5432/nestjs?schema=public"</span>
</code></pre></div>
</li>
<li>
<p>If the provider is not postgres update the <code>./prisma/schema.prisma</code> file with it</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js">datasource db <span class="token punctuation">{</span>
  provider <span class="token operator">=</span> <span class="token string">"postgresql"</span>
  url      <span class="token operator">=</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token string">"DATABASE_URL"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

generator client <span class="token punctuation">{</span>
  provider <span class="token operator">=</span> <span class="token string">"prisma-client-js"</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>If you are using vscode, this might also be a good opportunity to install the <code>Prisma VS Code Extension</code>, extension id: <code>Prisma.prisma</code></p>
</li>
<li>
<p>Start the local database</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">docker-compose</span> up
</code></pre></div>
</li>
<li>
<p>Create a Prisma Client <code>./src/utils/prisma/</code></p>
</li>
<li>
<p>Create <code>./src/utils/prisma/prisma.service.ts</code></p>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> OnModuleInit<span class="token punctuation">,</span> OnModuleDestroy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@prisma/client'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PrismaService</span> <span class="token keyword">extends</span> <span class="token class-name">PrismaClient</span> <span class="token keyword">implements</span> <span class="token class-name">OnModuleInit</span><span class="token punctuation">,</span> OnModuleDestroy <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onModuleInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">onModuleDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>Create <code>./src/utils/prisma/prisma.module.ts</code></p>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./prisma.service'</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>PrismaService<span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span> <span class="token punctuation">[</span>PrismaService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PrismaModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

</code></pre></div>
</li>
<li>
<p>When we want to modify the structure of our database, we should create a migration. It consists of a SQL script that is supposed to make the necessary changes. Although we could write it by hand, Prisma can do it for us with the Prisma Migrate tool.</p>
</li>
<li>
<p>Let's create a <code>./prisma/base.prisma</code> file to store the provider and datasource db</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html">// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
</code></pre></div>
</li>
<li>
<p>Now, let’s define a simple Quote model in our schema that we can store in our <code>./src/quotes</code> path. Create <code>./src/quotes/schema.prisma</code>. (Note: make sure you define the model with lowercase characters, PG doesn't like uppercase for table names)</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html">model quote {
  id        Int      @default(autoincrement()) @id
  quote     String
  author    String
}
</code></pre></div>
</li>
<li>
<p>We can use the <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#model-field-scalar-types">prisma data types</a> eventhough we've only used Int and String</p>
</li>
<li>
<p>In our Quote model, we also use the @id attribute. Thanks to that, our id field becomes the primary key.</p>
</li>
<li>
<p>Now we can update our <code>package.json</code> to contatenate all the primas schemas and update the <code>./prisma/schema.prisma</code> file with them all:</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"docker:db:up"</span><span class="token operator">:</span> <span class="token string">"docker-compose up"</span><span class="token punctuation">,</span>
    <span class="token property">"docker:db:down"</span><span class="token operator">:</span> <span class="token string">"docker-compose down"</span><span class="token punctuation">,</span>
    <span class="token property">"preprisma:snapshot"</span><span class="token operator">:</span> <span class="token string">"cat prisma/base.prisma > prisma/schema.prisma &#x26;&#x26; cat src/*/*.prisma >> prisma/schema.prisma"</span><span class="token punctuation">,</span>
    <span class="token property">"prisma:snapshot"</span><span class="token operator">:</span> <span class="token string">"npx prisma migrate dev --name migrate --preview-feature"</span><span class="token punctuation">,</span>
    <span class="token property">"preprisma:push"</span><span class="token operator">:</span> <span class="token string">"cat prisma/base.prisma > prisma/schema.prisma &#x26;&#x26; cat src/*/*.prisma >> prisma/schema.prisma"</span><span class="token punctuation">,</span>
    <span class="token property">"prisma:push"</span><span class="token operator">:</span> <span class="token string">"prisma db push"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>Create your first migration</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> prisma:snapshot
</code></pre></div>
</li>
<li>
<p>Update the database to have the new schema</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> prisma:push
</code></pre></div>
</li>
<li>
<p>We can now go to PGAdmin to see our database, got to http://localhost:8080
<img src="/assets/blog/nestjs/pgadmin-docker.jpg" alt="pgadmin-docker"></p>
<ul>
<li>Login with:
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  name<span class="token operator">:</span> container-postgresdb<span class="token punctuation">,</span>
  host<span class="token operator">:</span> host.docker.internal<span class="token punctuation">,</span>
  database<span class="token operator">:</span> postgres<span class="token punctuation">,</span>
  user<span class="token operator">:</span> postgres<span class="token punctuation">,</span>
  password<span class="token operator">:</span> admin
<span class="token punctuation">}</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<h1>Logging</h1>
<ul>
<li>
<p>NestJS is equipped with a logger ready to use out of the box.</p>
</li>
<li>
<p>Default logging</p>
</li>
<li>
<p>There are a few to choose from, sorted by &#x3C;SEVERITY_TYPE>:</p>
<ul>
<li>error</li>
<li>warn</li>
<li>log</li>
<li>verbose</li>
<li>debug</li>
</ul>
</li>
<li>
<p>Add a logger property to your service/controller e.g. <code>private readonly logger = new Logger(QuotesService.name)</code></p>
</li>
<li>
<p>Use the logger with this.logger.&#x3C;SEVERITY_TYPE>('whatever message')</p>
</li>
</ul>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuotesService</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">readonly</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Logger</span><span class="token punctuation">(</span>QuotesService<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

  <span class="token keyword">async</span> <span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'quote not found'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'[findOne]'</span><span class="token punctuation">,</span> <span class="token string">' not found'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h1>Authentication</h1>
<ul>
<li>You should really leverage (Passport)[https://www.passportjs.org/] &#x26; <a href="https://www.npmjs.com/package/bcrypt">bcrypt</a></li>
<li><a href="https://docs.nestjs.com/techniques/authentication">NestJS documentation</a> suggests using the Passport library and provides us with the means to do so. Passport gives us an abstraction over the authentication, thus relieving us from some heavy lifting. Also, it is heavily tested in production by many developers.</li>
<li><code>Guard</code> is responsible for determining whether the route handler handles the request or not. We're going to use Passport Guards in our controller</li>
<li><a href="https://docs.nestjs.com/security/authentication#implementing-passport-jwt">implementing-passport-jwt</a></li>
</ul>
<h2>Handling passwords</h2>
<ul>
<li>We never want to store passwords in plain-text in the databse, we want to hash them with a one directional.</li>
<li>Hashing algorithm transforms one string into another string.</li>
<li>We can also use <code>salt</code> to prevent hashes with the same values to look the same, think about if multiple users have the same password they would look the same</li>
<li><a href="https://www.npmjs.com/package/bcrypt">bcrypt</a> is a great hashing algorithm that takes care of hashing the strings, comparing plain strings with hashes, and appending salt. It also prevent against bruteforce because it limits the amount to attempt to compare strings</li>
<li><strong>NOTE:</strong> An important thing that we return the same error, whether the email or password is wrong. Doing so prevents some attacks that would aim to get a list of emails registered in our database.</li>
<li>Note that both techniques achieve the same end-result.
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// Technique 1 (generate a salt and hash on separate function calls):</span>
bcrypt<span class="token punctuation">.</span><span class="token method function property-access">genSalt</span><span class="token punctuation">(</span>saltRounds<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> salt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    bcrypt<span class="token punctuation">.</span><span class="token method function property-access">hash</span><span class="token punctuation">(</span>myPlaintextPassword<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> hash</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Store hash in your password DB.</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Technique 2 (auto-gen a salt and hash):</span>
bcrypt<span class="token punctuation">.</span><span class="token method function property-access">hash</span><span class="token punctuation">(</span>myPlaintextPassword<span class="token punctuation">,</span> saltRounds<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> hash</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Store hash in your password DB.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
</ul>
</div></div></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"><div class="py-28 flex flex-col lg:flex-row items-center"><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="/">Learn something else</a></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"nestjs","slug":"nestjs","content":"\u003ch1\u003eNest.js\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eNot to be confused with \u003ccode\u003eNext.js\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eNestjs is a nodejs framework for building server-side applications\u003c/li\u003e\n\u003cli\u003eUnder the hood, Nest makes use of robust HTTP Server frameworks like Express (the default) and optionally can be configured to use Fastify as well!\u003c/li\u003e\n\u003cli\u003eIt is somewhat opinionated and forces us to follow its vision of how an application should look like to some extent.\u003c/li\u003e\n\u003cli\u003eConcepts like: Controllers, Providers, Modules, Middleware, Pipes, Guards keeps you in a structed code base which in the JS world might be a breath of fresh air.\u003c/li\u003e\n\u003cli\u003eCheck out the official docs \u003ca href=\"https://docs.nestjs.com/\"\u003ehere\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eGetting started\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eInstall and use the Nest CLI\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e i -g @nestjs/cli\n$ nest new project-name\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eAlternatively you can clone the starter repo\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003egit\u003c/span\u003e clone https://github.com/nestjs/typescript-starter.git project\n$ \u003cspan class=\"token builtin class-name\"\u003ecd\u003c/span\u003e project\n$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e run start\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eYou can also just update your package.json to have:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"new\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nest generate resource\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eBeing opinionated, you're gonna want to structure your routes with controller/service potentially models \u0026#x26; stores\u003c/li\u003e\n\u003cli\u003eUpdate the linting\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003eInstall some packages\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# Linting packages\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e -D @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint-config-prettier eslint-plugin-prettier prettier @trivago/prettier-plugin-sort-imports\n\n$ \u003cspan class=\"token function\"\u003emkdir\u003c/span\u003e .vscode\n$ \u003cspan class=\"token function\"\u003etouch\u003c/span\u003e .vscode/settings.json .prettierrc .eslintrc \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eUpdate the \u003ccode\u003e.eslint.js\u003c/code\u003e file\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003emodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003eparser\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@typescript-eslint/parser'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003eparserOptions\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eproject\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'tsconfig.json'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003etsconfigRootDir\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e __dirname\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003esourceType\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'module'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003eplugins\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'@typescript-eslint/eslint-plugin'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'plugin:@typescript-eslint/recommended'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'plugin:prettier/recommended'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003eroot\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003eenv\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003enode\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003ejest\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003eignorePatterns\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'.eslintrc.js'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eAdd to the \u003ccode\u003e./.prettierrc\u003c/code\u003e file\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"semi\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"trailingComma\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"all\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"singleQuote\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"printWidth\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"importOrder\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"^@core/(.*)$\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^@server/(.*)$\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^@ui/(.*)$\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^[./]\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"importOrderSeparation\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003eAdd to the \u003ccode\u003e./.vscode/settings.json\u003c/code\u003e file\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Set prettier to be the default formatter\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"editor.defaultFormatter\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"esbenp.prettier-vscode\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// Don't format any files by default\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"editor.formatOnSave\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \n  \u003cspan class=\"token property\"\u003e\"[json]\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"editor.defaultFormatter\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"esbenp.prettier-vscode\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"editor.formatOnSave\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// JavaScript stuff\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"[javascript]\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"editor.defaultFormatter\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"esbenp.prettier-vscode\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"editor.formatOnSave\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// TypeScript stuff if you need it\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"[typescript]\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"editor.defaultFormatter\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"esbenp.prettier-vscode\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"editor.formatOnSave\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003eAdd dotenv for the custom port\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e dotenv\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e NestFactory \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/core'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e dotenv \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'dotenv'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e AppModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./app.module'\u003c/span\u003e\n\ndotenv\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eenv\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e3000\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ebootstrap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e app \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e NestFactory\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eAppModule\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token builtin\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e⚡ The magic happens at: http://localhost:\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e app\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elisten\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ebootstrap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"6\"\u003e\n\u003cli\u003eZip the dist folder with only the node_modules needed for the app\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eInstall a zipper package\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e lambda-zipper -D\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eUpdate the \u003ccode\u003epackage.json\u003c/code\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"build\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nest build\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"postbuild\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"lambda-zipper build -f dist -o build/app.zip\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"start\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"node main\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"format\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"prettier --write \\\"src/*.ts\\\" \\\"src/**/*.ts\\\" \\\"test/**/*.ts\\\"\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e make sure you update the \u003ccode\u003estart\u003c/code\u003e script to \u003ccode\u003e\"start\": \"node main\"\u003c/code\u003e so the build version of the app works\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eMake your first route\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSo the default app is very bare-bones, let's add a component based route\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate an entire route resource with one command\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ nest generate resource quotes\n$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e lint\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e(or) Create the controller/service/module with the CLI\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ nest generate controller quotes\n$ nest generate module quotes\n$ nest generate \u003cspan class=\"token function\"\u003eservice\u003c/span\u003e quotes\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThis will create a bunch of files\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003esrc/quotes\n├── dto\n│   ├── create-quote.dto.ts\n│   └── update-quote.dto.ts\n├── entities\n│   └── quote.entity.ts\n├── quotes.controller.spec.ts\n├── quotes.controller.ts\n├── quotes.module.ts\n├── quotes.service.spec.ts\n└── quotes.service.ts\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNestJS provides a  \u003ccode\u003e@Body()\u003c/code\u003e decorator that gives us easy access to the body.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edto\u003c/code\u003e stands for Data Transfer Object and it defines the format of the data sent in a request.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIt can be either an interface or a class\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eControllers's sole responsibility is to deal with http request/response, as for the \u003ccode\u003eservice\u003c/code\u003e's responsibility is to deal with business logic. You could also take it a step further and create \u003ccode\u003emodels\u003c/code\u003e or \u003ccode\u003estore\u003c/code\u003e to deal with querying the database however if you are using a ORM you could probably ignore the \u003ccode\u003estore\u003c/code\u003e for the DB is agnostic\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSOILD principles with the goal that makes our software easier to understand/maintain/read\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eS\u003c/strong\u003e\u003ccode\u003eingle responsibilty\u003c/code\u003e principle: a class/module should obly be responsible for a single function\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eO\u003c/strong\u003e\u003ccode\u003epen-closed\u003c/code\u003e principle: software entities should be open for extension but closed for modification.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eL\u003c/strong\u003e\u003ccode\u003eiskov substitution\u003c/code\u003e principle: changing one area of our system does not break other parts.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eI\u003c/strong\u003e\u003ccode\u003enterface segregation\u003c/code\u003e principle: emphasis on creating smaller and more specific interfaces. No client should be forced to depend on methods it does not use. By putting too many properties in our interfaces, we risk breaking the above rule.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eD\u003c/strong\u003e\u003ccode\u003eependency inversion\u003c/code\u003e principle: high-level modules should not depend on the low-level modules. Instead, both of them should depend on abstractions.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- https://wanago.io/2020/02/03/applying-solid-principles-to-your-typescript-code/ --\u003e\n\u003ch2\u003eValidator\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eLeveraging your DTO to do validation by adding some class-decorators. Info \u003ca href=\"https://www.npmjs.com/package/class-validator\"\u003ehere\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003enote\u003c/strong\u003e: you want to add it as a devDependency to keep the build version of the application at a minimum\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e -D class-validator class-transformer\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e IsNotEmpty\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Length \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'class-validator'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCreateQuoteDto\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eIsNotEmpty\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e    \u003cspan class=\"token comment\"\u003e// validator\u003c/span\u003e\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eLength\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e      \u003cspan class=\"token comment\"\u003e// validator\u003c/span\u003e\n  quote\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eLength\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e30\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// validator\u003c/span\u003e\n  author\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003enow in the POST code should look like this:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePost\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eUsePipes\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eValidationPipe\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e       \u003cspan class=\"token comment\"\u003e// we can add pipes to validate the defined DTO\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eBody\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e createQuoteDto\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e CreateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecreateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNow if you try to do a POST in the client and the body doesn't validate Nestjs will send a \u003ccode\u003e400\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eController\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRemember that the Controller's job is to deal with http request/response and use the service methods to do all the business logic\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAlso notice that with Nestjs we can leverage decorators for defining HTTP verbs and accessing the POST/PUT bodies\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  Controller\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Get\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Post\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Put\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Body\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Param\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Delete\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  UsePipes\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  ValidationPipe\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Added this package to deal with validation of the DTO\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e CreateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./dto/create-quote.dto'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e UpdateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./dto/update-quote.dto'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e QuotesService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./quotes.service'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eController\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'quotes'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuotesController\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereadonly\u003c/span\u003e quotesService\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e QuotesService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePost\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eUsePipes\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eValidationPipe\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Validate the Data Transfer Object\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eBody\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e createQuoteDto\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e CreateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecreateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003efindAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e':id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eParam\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePut\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e':id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eUsePipes\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eValidationPipe\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Validate the Data Transfer Object\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003eupdate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eParam\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eBody\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e updateQuoteDto\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e UpdateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eupdate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e updateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eDelete\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e':id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eParam\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eThe Service file\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eThe job of a service is to separate the business logic from controllers, making it cleaner and more comfortable to test.\u003c/li\u003e\n\u003cli\u003eHe's the default service created by the Nestjs command, with some in-memory object storage\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Injectable \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e CreateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./dto/create-quote.dto'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e UpdateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./dto/update-quote.dto'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eInjectable\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuotesService\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e lastQuotetId \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e quotes \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecreateQuoteDto\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e CreateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e id \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elastQuotetId\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e newItem \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e...\u003c/span\u003ecreateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e newItem\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e newItem \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token function\"\u003efindAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e Object\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eentries\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e data \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eid\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e item \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e item \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token function\"\u003eupdate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eid\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e updateQuoteDto\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e UpdateQuoteDto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e updateQuoteDto\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token function\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eid\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e deletedItem \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edelete\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      message\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Deleted'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      data\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e deletedItem\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eModules\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWe use modules to organize our application, so this complete route will be packaged in a module:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Module \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e QuotesController \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./quotes.controller'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e QuotesService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./quotes.service'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  controllers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eQuotesController\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eQuotesService\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuotesModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eAnd the module will be added to the \u003cstrong\u003eroot module\u003c/strong\u003e*, \u003ccode\u003e./src/app.module.ts\u003c/code\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Module \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e QuotesModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./quotes/quotes.module'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eQuotesModule\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  controllers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAppModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eUsing \u003ccode\u003eConfigService\u003c/code\u003e to deal with environment variables\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eDocs \u003ca href=\"https://docs.nestjs.com/techniques/configuration\"\u003ehere\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn Node.js applications, it's common to use .env files, holding key-value pairs where each key represents a particular value, to represent each environment. Running an app in different environments is then just a matter of swapping in the correct .env file.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eA good approach for using this technique in Nest is to create a \u003ccode\u003eConfigModule\u003c/code\u003e that exposes a \u003ccode\u003eConfigService\u003c/code\u003e which loads the appropriate .env file. While you may choose to write such a module yourself, for convenience Nest provides the \u003ccode\u003e@nestjs/config\u003c/code\u003e package out-of-the box.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003e@nestjs/config\u003c/code\u003e package internally uses \u003ccode\u003edotenv\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e @nestjs/config\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eapp.module.ts\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Module \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e ConfigModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/config'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eConfigModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforRoot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAppModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou can specify which \u003ccode\u003e.env\u003c/code\u003e file to use in the \u003ccode\u003eapp.module.ts\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Module \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e ConfigModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/config'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e QuotesModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./quotes/quotes.module'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e EnvModule \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ConfigModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforRoot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  envFilePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'.env.development'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'.env'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eEnvModule\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e QuotesModule\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// The order matters\u003c/span\u003e\n  controllers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAppModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eAdd Swagger\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eOpenAPI\u003c/code\u003e \u0026#x26; \u003ccode\u003eSwagger\u003c/code\u003e, we can create a user interface that serves as interactive API documentation for our project.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003eOpenAPI\u003c/code\u003e is a specification used to describe our API and gives us a way to provide the details of our endpoints.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSwagger\u003c/code\u003e is a set of tools built around the \u003ccode\u003eOpenAPI\u003c/code\u003e specification. It allows us to render the OpenAPI specification we wrote in as the API documentation. The thing that makes it so valuable is that it is interactive.\u003c/li\u003e\n\u003cli\u003eInstall some packages:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e @nestjs/swagger swagger-ui-express\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eCreate a \u003ccode\u003e./src/utils/swagger.ts\u003c/code\u003e file\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e DocumentBuilder\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e SwaggerModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/swagger'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eSetupSwagger\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eapp\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e swaggerConfig \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eDocumentBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esetTitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'API with NestJS'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esetDescription\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'API developed throughout the API with NestJS course'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esetVersion\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'1.0'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ebuild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e document \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e SwaggerModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateDocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eapp\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e swaggerConfig\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  SwaggerModule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esetup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'docs'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e app\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eUpdate your \u003ccode\u003e./src/main.ts\u003c/code\u003e file to include your Swagger addition\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e ConfigService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/config'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e NestFactory \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/core'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e AppModule \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./app.module'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e SetupSwagger \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./utils/swagger'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ebootstrap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e app \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e NestFactory\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eAppModule\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e configService \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e app\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eConfigService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// Swagger\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003eSetupSwagger\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eapp\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// This line here to add swagger\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e configService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'PORT'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e??\u003c/span\u003e \u003cspan class=\"token number\"\u003e3000\u003c/span\u003e\n  \u003cspan class=\"token builtin\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e⚡ The magic happens at: http://localhost:\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e app\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elisten\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePORT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ebootstrap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eUnfortunately, the specification we’ve defined so far does not contain much detail. So update the \u003ccode\u003e./nest-cli.json\u003c/code\u003e so that the schema can show up in the Swagger doc, update the \u003ccode\u003ecompilerOptions.plugins\u003c/code\u003e to include nestjs swagger\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"compilerOptions\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"plugins\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"@nestjs/swagger\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\"@nestjs/swagger\" leverage your DTO objects that you create\u003c/li\u003e\n\u003cli\u003eYou can also group your calls my using the \u003ccode\u003eimport { ApiTags } from '@nestjs/swagger';\u003c/code\u003e in your controllers:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  Controller\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Get\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Post\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Put\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Body\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Param\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  Delete\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  UsePipes\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  ValidationPipe\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e ApiTags \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/swagger'\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// Import this\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e CreateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./dto/create-quote.dto'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e UpdateQuoteDto \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./dto/update-quote.dto'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e QuotesService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./quotes.service'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eController\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'quotes'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eApiTags\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Quotes'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// Add this \u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuotesController\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eYou can also describe your endpoints with more details. We can use decorators such as \u003ccode\u003e@ApiParam()\u003c/code\u003e and \u003ccode\u003e@ApiResponse()\u003c/code\u003e to provide more details about our endpoints.\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eController\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'quotes'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eApiTags\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Quotes'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuotesController\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereadonly\u003c/span\u003e quotesService\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e QuotesService\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e':id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eApiParam\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    required\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    description\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Should be an id of a quote that exists in the database'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Number\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eParam\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eAdd a database with Prisma\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eWith Prisma, we describe our data using a Prisma schema file. It uses its own data modeling language and acts as a single source of truth. This differs from traditional ORMs that provide an object-oriented way of working with the database.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eEvery time we make changes to the schema file, we need to generate the Prisma client. In this process, Prisma parses our schema and creates a client along with all the TypeScript typings. This means that we no don't map SQL tables to model classes through the TypeScript code manually.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's use Docker to deal with the database\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-yml\"\u003e\u003ccode class=\"language-yml\"\u003e\u003cspan class=\"token key atrule\"\u003eversion\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"3\"\u003c/span\u003e\n\u003cspan class=\"token key atrule\"\u003eservices\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003epostgres\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003econtainer_name\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e nestjs\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003epostgres\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e postgres\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003elatest\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"5432:5432\"\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e ./volumes/postgres\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e/data/postgres\n    \u003cspan class=\"token key atrule\"\u003eenv_file\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e docker.env\n    \u003cspan class=\"token key atrule\"\u003enetworks\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e postgres\n\n  \u003cspan class=\"token key atrule\"\u003epgadmin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003elinks\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e postgres\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003epostgres\n    \u003cspan class=\"token key atrule\"\u003econtainer_name\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e nestjs\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003epgadmin\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e dpage/pgadmin4\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"8080:80\"\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e ./volumes/pgadmin\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e/root/.pgadmin\n    \u003cspan class=\"token key atrule\"\u003eenv_file\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e docker.env\n    \u003cspan class=\"token key atrule\"\u003enetworks\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e postgres\n\n\u003cspan class=\"token key atrule\"\u003enetworks\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003epostgres\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003edriver\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e bridge\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a \u003ccode\u003edocker.env\u003c/code\u003e file to deal with the postgres configs\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token assign-left variable\"\u003ePOSTGRES_USER\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eadmin\n\u003cspan class=\"token assign-left variable\"\u003ePOSTGRES_PASSWORD\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eadmin\n\u003cspan class=\"token assign-left variable\"\u003ePOSTGRES_DB\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003enestjs\n\u003cspan class=\"token assign-left variable\"\u003ePGADMIN_DEFAULT_EMAIL\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eadmin@admin.com\n\u003cspan class=\"token assign-left variable\"\u003ePGADMIN_DEFAULT_PASSWORD\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eadmin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInstall prisma\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e prisma @prisma/client\n$ npx prisma init\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePrisma will create a \u003ccode\u003e./prisma/schema.prisma\u003c/code\u003e \u0026#x26; add the database url to the \u003ccode\u003e.env\u003c/code\u003e file.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUpdate the \u003ccode\u003e.env\u003c/code\u003e to use the database url we're gonna use with docker-compose postgres service\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token assign-left variable\"\u003eDATABASE_URL\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"postgresql://admin:admin@localhost:5432/nestjs?schema=public\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf the provider is not postgres update the \u003ccode\u003e./prisma/schema.prisma\u003c/code\u003e file with it\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003edatasource db \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  provider \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"postgresql\"\u003c/span\u003e\n  url      \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eenv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"DATABASE_URL\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\ngenerator client \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  provider \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"prisma-client-js\"\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf you are using vscode, this might also be a good opportunity to install the \u003ccode\u003ePrisma VS Code Extension\u003c/code\u003e, extension id: \u003ccode\u003ePrisma.prisma\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eStart the local database\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e up\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a Prisma Client \u003ccode\u003e./src/utils/prisma/\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate \u003ccode\u003e./src/utils/prisma/prisma.service.ts\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Injectable\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e OnModuleInit\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e OnModuleDestroy \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e PrismaClient \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@prisma/client'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eInjectable\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePrismaService\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePrismaClient\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eOnModuleInit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e OnModuleDestroy \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token function\"\u003eonModuleInit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$connect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token function\"\u003eonModuleDestroy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$disconnect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate \u003ccode\u003e./src/utils/prisma/prisma.module.ts\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Module \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@nestjs/common'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e PrismaService \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./prisma.service'\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  controllers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ePrismaService\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  exports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ePrismaService\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePrismaModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhen we want to modify the structure of our database, we should create a migration. It consists of a SQL script that is supposed to make the necessary changes. Although we could write it by hand, Prisma can do it for us with the Prisma Migrate tool.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's create a \u003ccode\u003e./prisma/base.prisma\u003c/code\u003e file to store the provider and datasource db\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e// This is your Prisma schema file,\n// learn more about it in the docs: https://pris.ly/d/prisma-schema\n\ngenerator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNow, let’s define a simple Quote model in our schema that we can store in our \u003ccode\u003e./src/quotes\u003c/code\u003e path. Create \u003ccode\u003e./src/quotes/schema.prisma\u003c/code\u003e. (Note: make sure you define the model with lowercase characters, PG doesn't like uppercase for table names)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003emodel quote {\n  id        Int      @default(autoincrement()) @id\n  quote     String\n  author    String\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWe can use the \u003ca href=\"https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#model-field-scalar-types\"\u003eprisma data types\u003c/a\u003e eventhough we've only used Int and String\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn our Quote model, we also use the @id attribute. Thanks to that, our id field becomes the primary key.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNow we can update our \u003ccode\u003epackage.json\u003c/code\u003e to contatenate all the primas schemas and update the \u003ccode\u003e./prisma/schema.prisma\u003c/code\u003e file with them all:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"docker:db:up\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"docker-compose up\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"docker:db:down\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"docker-compose down\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"preprisma:snapshot\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"cat prisma/base.prisma \u003e prisma/schema.prisma \u0026#x26;\u0026#x26; cat src/*/*.prisma \u003e\u003e prisma/schema.prisma\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"prisma:snapshot\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"npx prisma migrate dev --name migrate --preview-feature\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"preprisma:push\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"cat prisma/base.prisma \u003e prisma/schema.prisma \u0026#x26;\u0026#x26; cat src/*/*.prisma \u003e\u003e prisma/schema.prisma\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"prisma:push\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"prisma db push\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate your first migration\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e prisma:snapshot\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUpdate the database to have the new schema\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e prisma:push\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWe can now go to PGAdmin to see our database, got to http://localhost:8080\n\u003cimg src=\"/assets/blog/nestjs/pgadmin-docker.jpg\" alt=\"pgadmin-docker\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLogin with:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e container-postgresdb\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  host\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e host.docker.internal\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  database\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e postgres\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  user\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e postgres\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  password\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e admin\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eLogging\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eNestJS is equipped with a logger ready to use out of the box.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDefault logging\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThere are a few to choose from, sorted by \u0026#x3C;SEVERITY_TYPE\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eerror\u003c/li\u003e\n\u003cli\u003ewarn\u003c/li\u003e\n\u003cli\u003elog\u003c/li\u003e\n\u003cli\u003everbose\u003c/li\u003e\n\u003cli\u003edebug\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAdd a logger property to your service/controller e.g. \u003ccode\u003eprivate readonly logger = new Logger(QuotesService.name)\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUse the logger with this.logger.\u0026#x3C;SEVERITY_TYPE\u003e('whatever message')\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eInjectable\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuotesService\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereadonly\u003c/span\u003e logger \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eLogger\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eQuotesService\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eid\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'quote not found'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elogger\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ewarn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'[findOne]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e' not found'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1\u003eAuthentication\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eYou should really leverage (Passport)[https://www.passportjs.org/] \u0026#x26; \u003ca href=\"https://www.npmjs.com/package/bcrypt\"\u003ebcrypt\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.nestjs.com/techniques/authentication\"\u003eNestJS documentation\u003c/a\u003e suggests using the Passport library and provides us with the means to do so. Passport gives us an abstraction over the authentication, thus relieving us from some heavy lifting. Also, it is heavily tested in production by many developers.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGuard\u003c/code\u003e is responsible for determining whether the route handler handles the request or not. We're going to use Passport Guards in our controller\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.nestjs.com/security/authentication#implementing-passport-jwt\"\u003eimplementing-passport-jwt\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eHandling passwords\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWe never want to store passwords in plain-text in the databse, we want to hash them with a one directional.\u003c/li\u003e\n\u003cli\u003eHashing algorithm transforms one string into another string.\u003c/li\u003e\n\u003cli\u003eWe can also use \u003ccode\u003esalt\u003c/code\u003e to prevent hashes with the same values to look the same, think about if multiple users have the same password they would look the same\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.npmjs.com/package/bcrypt\"\u003ebcrypt\u003c/a\u003e is a great hashing algorithm that takes care of hashing the strings, comparing plain strings with hashes, and appending salt. It also prevent against bruteforce because it limits the amount to attempt to compare strings\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e An important thing that we return the same error, whether the email or password is wrong. Doing so prevents some attacks that would aim to get a list of emails registered in our database.\u003c/li\u003e\n\u003cli\u003eNote that both techniques achieve the same end-result.\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// Technique 1 (generate a salt and hash on separate function calls):\u003c/span\u003e\nbcrypt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egenSalt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esaltRounds\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e salt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    bcrypt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ehash\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emyPlaintextPassword\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e salt\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e hash\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// Store hash in your password DB.\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Technique 2 (auto-gen a salt and hash):\u003c/span\u003e\nbcrypt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ehash\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emyPlaintextPassword\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e saltRounds\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e hash\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Store hash in your password DB.\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","ogImage":{"url":"/assets/covers/_blank_.jpg"},"coverImage":"/assets/covers/_blank_.jpg"}},"__N_SSG":true},"page":"/learn/[slug]","query":{"slug":"nestjs"},"buildId":"dWSqlyL7gXbmQPbidqy9q","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>