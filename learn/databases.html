<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="Not another learning site."/><meta property="og:image" content="https://og-image.now.sh/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><title>Not another learning site.</title><meta property="og:image" content="/assets/covers/database.jpg"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/b7eda3288cebd843.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b7eda3288cebd843.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cf121497002c184d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cf121497002c184d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-779b41245c009d2a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-156acf25c3b6001c.js" defer=""></script><script src="/_next/static/chunks/664-4243e6d8b13d56da.js" defer=""></script><script src="/_next/static/chunks/pages/learn/%5Bslug%5D-f7c40571bdb12048.js" defer=""></script><script src="/_next/static/F_4jQJj_eSRzbufUlGt55/_buildManifest.js" defer=""></script><script src="/_next/static/F_4jQJj_eSRzbufUlGt55/_ssgManifest.js" defer=""></script><script src="/_next/static/F_4jQJj_eSRzbufUlGt55/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="min-h-screen"><main><div class="container mx-auto px-5"><div style="position:fixed;background-color:rgba(255,255,255,0.9);backdrop-filter:blur(10px);width:100%;left:0px;z-index:1000"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8" style="padding:0;padding-left:10px;margin-bottom:20px"><a class="hover:underline" href="/">Learn</a>.</h2></div><article class="mb-32"><div style="height:100px"></div><h1 class="text-6xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">Databases</h1><div class="mb-8 md:mb-16 sm:mx-0"><div class="sm:mx-0"><img src="/assets/covers/database.jpg" alt="Cover Image for Databases" class="shadow-sm" layout="responsive" width="1240" height="620"/></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><div>TODO: add language chip here</div></div></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__h_8de"><h1>Databases</h1>
<ul>
<li>[x] MySQL + baked in spatial functions</li>
<li>[x] PostgreSQL + PostGIS</li>
<li>[x] Firebase</li>
<li>[x] DynamoDB</li>
<li>[ ] SQLite + SpatiaLite</li>
<li>[ ] MongoDB</li>
<li>[ ] CouchDB</li>
</ul>
<h1>MySQL</h1>
<ul>
<li>Basic Docker stuff
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># show all running containers</span>
$ <span class="token function">docker</span> <span class="token function">ps</span>

<span class="token comment"># Show all stoped containers</span>
$ <span class="token function">docker</span> <span class="token function">ps</span> -a

<span class="token comment"># Pull the latest image</span>
$ <span class="token function">docker</span> pull mysql/mysql-server:latest

<span class="token comment"># Create &#x26; run a container</span>
$ <span class="token function">docker</span> run --name some-mysql -p <span class="token number">3306</span>:3306  -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456789</span> -d mysql

<span class="token comment"># stop/start</span>
$ <span class="token function">docker</span> stop some-mysql
$ <span class="token function">docker</span> start some-mysql


<span class="token comment"># Docker cleanups</span>
$ <span class="token function">docker</span> system prune
$ <span class="token function">docker</span> image prune

<span class="token comment"># Create a database dump</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> some-mysql <span class="token function">sh</span> -c <span class="token string">'exec mysqldump --all-databases -uroot -p"$MYSQL_ROOT_PASSWORD"'</span> <span class="token operator">></span> /some/path/on/your/host/all-databases.sql

<span class="token comment"># Restoring data from a dump file</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> -i some-mysql <span class="token function">sh</span> -c <span class="token string">'exec mysql -uroot -p"$MYSQL_ROOT_PASSWORD"'</span> <span class="token operator">&#x3C;</span> /some/path/on/your/host/all-databases.sql
</code></pre></div>
</li>
</ul>
<h2>Connecting to your Database (MySQL v8)</h2>
<ul>
<li>
<p>First spin up a docker container</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># Pull the latest image</span>
$ <span class="token function">docker</span> pull mysql/mysql-server:latest

<span class="token comment"># Create &#x26; run a container</span>
$ <span class="token function">docker</span> run --name some-mysql -p <span class="token number">3306</span>:3306 -p <span class="token number">33060</span>:33060  -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456789</span> -d mysql
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it some-mysql mysql -uroot -p
mysql<span class="token operator">></span> CREATE DATABASE letsgetspatial<span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Connecting to the <code>MySQL v8</code> Database with <a href="https://marketplace.visualstudio.com/items?itemName=mtxr.sqltools"><code>SQLTools</code> extension</a>. You will also have to download the Extensions drivers: MySQL</p>
<ul>
<li><em>NOTE</em> we had to make a database <code>letsgetspatial</code> manually above</li>
<li>Add the connection config to your <code>./.vscode/settings.json</code> file
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"sqltools.connections"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"mysqlOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"authProtocol"</span><span class="token operator">:</span> <span class="token string">"xprotocol"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"previewLimit"</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
      <span class="token property">"server"</span><span class="token operator">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
      <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">33060</span><span class="token punctuation">,</span>
      <span class="token property">"driver"</span><span class="token operator">:</span> <span class="token string">"MySQL"</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"MySQL_v8"</span><span class="token punctuation">,</span>
      <span class="token property">"database"</span><span class="token operator">:</span> <span class="token string">"letsgetspatial"</span><span class="token punctuation">,</span>
      <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
      <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"123456789"</span><span class="token punctuation">,</span>
      <span class="token property">"connectionTimeout"</span><span class="token operator">:</span> <span class="token number">15</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ul>
<li><img src="/assets/blog/database/vscode-sqltools.jpg" alt="vscode-sqltools"></li>
</ul>
</li>
<li>Click the <code>Test Connection</code> (it kinda appears like a white rectanglar button)</li>
<li>Under the <code>Connection</code> section in the side panel click this <code>some-mysql</code> connection and it will open up a sql window where you can write queries</li>
<li>Use <code>--</code> to write comments &#x26; <code>-- @block</code> to write blocks that you can execute only the block</li>
</ul>
</li>
<li>
<p>Backing up data</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># Create a database dump</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> some-mysql <span class="token function">sh</span> -c <span class="token string">'exec mysqldump --all-databases -uroot -p"$MYSQL_ROOT_PASSWORD"'</span> <span class="token operator">></span> /some/path/on/your/host/all-databases.sql

<span class="token comment"># Restoring data from a dump file</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> -i some-mysql <span class="token function">sh</span> -c <span class="token string">'exec mysql -uroot -p"$MYSQL_ROOT_PASSWORD"'</span> <span class="token operator">&#x3C;</span> /some/path/on/your/host/all-databases.sql
</code></pre></div>
</li>
</ul>
<h2>Docker Compose way</h2>
<ul>
<li>Where gonna use <code>docker-compose</code> to make our lives easier
<ul>
<li>
<p>Create a <code>docker-compose.yml</code> files with:</p>
<div class="remark-highlight"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.3'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>latest
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> <span class="token string">'letsgetspatial'</span>
      <span class="token comment"># So you don't have to use root, but you can if you like</span>
      <span class="token key atrule">MYSQL_USER</span><span class="token punctuation">:</span> <span class="token string">'user'</span>
      <span class="token comment"># You can use whatever password you like</span>
      <span class="token key atrule">MYSQL_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">'password'</span>
      <span class="token comment"># Password for root access</span>
      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">'password'</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token comment"># &#x3C;Port exposed> : &#x3C; MySQL Port running inside container></span>
      <span class="token punctuation">-</span> <span class="token string">'3306:3306'</span>
      <span class="token punctuation">-</span> <span class="token string">'33060:33060'</span>
    <span class="token key atrule">expose</span><span class="token punctuation">:</span>
      <span class="token comment"># Opens port 3306 on the container</span>
      <span class="token punctuation">-</span> <span class="token string">'3306'</span>
      <span class="token punctuation">-</span> <span class="token string">'33060'</span>
      <span class="token comment"># Where our data will be persisted</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> my<span class="token punctuation">-</span>db<span class="token punctuation">:</span>/var/lib/mysql
      
  <span class="token comment"># http://localhost:8080/ to log into your DB</span>
  <span class="token key atrule">adminer</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> adminer
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8080<span class="token punctuation">:</span><span class="token number">8080</span>
      
<span class="token comment"># Names our volume</span>
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  my<span class="token punctuation">-</span>db<span class="token punctuation">:</span>
</code></pre></div>
</li>
<li>
<p>Now we can run one command to get it all running:</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># build/run contains</span>
$ <span class="token function">docker-compose</span> up

<span class="token comment"># stop all containers (for ctl+c twice)</span>
$ <span class="token function">docker-compose</span> down

<span class="token comment"># Clean up everything</span>
$ <span class="token function">docker-compose</span> down -v --rmi all --remove-orphans
</code></pre></div>
</li>
<li>
<p>You can connect to the container directly or connect with the mysql client or use the http://localhost:8080 to get a GUI for full access</p>
</li>
<li>
<p><img src="/assets/blog/database/mysql-gui.jpg" alt="mysql-gui"></p>
</li>
</ul>
</li>
</ul>
<h2>MySQL SQL Statements</h2>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Users<span class="token punctuation">(</span>
  id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  email  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
  bio <span class="token keyword">TEXT</span><span class="token punctuation">,</span>
  country <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Users<span class="token punctuation">(</span>
  email<span class="token punctuation">,</span>
  bio<span class="token punctuation">,</span>
  country
<span class="token punctuation">)</span> 
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>
  <span class="token string">'hello@world.com'</span><span class="token punctuation">,</span>
  <span class="token string">'I love strangers'</span><span class="token punctuation">,</span>
  <span class="token string">'US'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Users<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Bookings<span class="token punctuation">(</span>
  id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  guest_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  room_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  start_date <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  end_date <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  price <span class="token keyword">int</span><span class="token punctuation">,</span>
  total <span class="token keyword">int</span><span class="token punctuation">,</span>
  created_at <span class="token keyword">datetime</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Rooms<span class="token punctuation">(</span>
  owner_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  price <span class="token keyword">INT</span><span class="token punctuation">,</span>
  hot_tub <span class="token keyword">boolean</span><span class="token punctuation">,</span>
  home_type <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  room_type <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  total_occupancy <span class="token keyword">INT</span><span class="token punctuation">,</span>
  total_bedrooms <span class="token keyword">INT</span><span class="token punctuation">,</span>
  total_bathrooms <span class="token keyword">INT</span><span class="token punctuation">,</span>
  summary <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  created_at <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  updated_at <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  latitude <span class="token keyword">FLOAT</span><span class="token punctuation">,</span>
  longitude <span class="token keyword">FLOAT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<h2>MySQL with Spatial Data</h2>
<ul>
<li>
<p><strong>MySQL <code>POINT(lng,lat)</code>, just like PostGIS maintains (lng,lat), however... the <code>ST_GeomFromText</code> like <code>ST_GeomFromText('POINT(45.5051 -122.6750)', 4326)</code> DOES <code>LAT/LNG</code>??</strong></p>
</li>
<li>
<p>There is HUGE difference from MySQL v5.7 to v8.0</p>
</li>
<li>
<p>Prior to v8 spatial data there wasn't multiple spatial reference systems and geographic computations all computations were Catesian</p>
</li>
<li>
<p>So what is the least you need to know about??</p>
<ul>
<li>GIS libraries use <a href="https://epsg.io/">EPSG</a> (EPSG actually stands for <code>European Petroleum Survey Group</code>) codes as Spatial Reference System Identifiers (SRIDs)</li>
<li>All you need to know when working with spatial data on the web is most maps use the Spatial Reference System of <code>4326</code> which is <code>WGS 84 (Google Earth is in a Geographic coordinate system)</code></li>
<li>Geospatial data is should be stored in internal geometry format either <code>Well-Known Text (WKT)</code> or <code>Well-Known Binary (WKB)</code> format.</li>
</ul>
</li>
<li>
<p><code>Point(X,Y)</code> is a constructor for numbers with precision and does not require converting first to text making it faster.</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token comment">-- Slower</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SOME_DB <span class="token punctuation">(</span>name<span class="token punctuation">,</span> coordinates<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"Portland"</span><span class="token punctuation">,</span> ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POINT(45.5051 -122.6750)'</span><span class="token punctuation">,</span> <span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- Faster</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SOME_DB <span class="token punctuation">(</span>name<span class="token punctuation">,</span> coordinates<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"Portland"</span><span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.6750</span><span class="token punctuation">,</span> <span class="token number">45.5051</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Let's define some points instead of 2 columns lat/long</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>places<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>coordinates<span class="token punctuation">`</span></span> <span class="token keyword">POINT</span> SRID <span class="token number">4326</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Let's create an idex</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> pt_idx <span class="token keyword">ON</span> places<span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Now let's add some points</p>
<ul>
<li><strong>NOTE</strong> the <code>POINT(LNG, LAT)</code> format</li>
</ul>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>places<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>coordinates<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"Portland"</span><span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.6795</span><span class="token punctuation">,</span> <span class="token number">45.52054</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>places<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>coordinates<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"Vancouver"</span><span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">123.1207</span><span class="token punctuation">,</span> <span class="token number">49.2827</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>places<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>coordinates<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"Seattle"</span><span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.33551</span><span class="token punctuation">,</span> <span class="token number">47.604311</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>places<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>coordinates<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"San Francisco"</span><span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.416534</span><span class="token punctuation">,</span> <span class="token number">37.771800273</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>places<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>coordinates<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"Ottawa"</span><span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.697174</span><span class="token punctuation">,</span> <span class="token number">45.42062</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Select Data</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> ST_AsText<span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span> <span class="token keyword">FROM</span> places<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> ST_AsGeoJSON<span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span> <span class="token keyword">FROM</span> places<span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Calculate distances</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token comment">-- Distance from the montreal</span>
<span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>
ST_Distance_Sphere<span class="token punctuation">(</span>coordinates<span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">73.6049652</span><span class="token punctuation">,</span> <span class="token number">45.503459</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> places<span class="token punctuation">;</span>

<span class="token comment">-- Distance less that 500Km (500000m) from the montreal </span>
<span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> places
<span class="token keyword">WHERE</span> ST_Distance_Sphere<span class="token punctuation">(</span>coordinates<span class="token punctuation">,</span> ST_SRID<span class="token punctuation">(</span><span class="token keyword">POINT</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">73.6049652</span><span class="token punctuation">,</span> <span class="token number">45.503459</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&#x3C;</span> <span class="token number">500000</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Selects all points in a polygon</p>
</li>
<li>
<p>If you look closer, you’ll notice that the last point is the same as the first one and we have 5 points. This is because we need to “close” the polygon.</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SET</span> <span class="token variable">@polygon</span> <span class="token operator">=</span> ST_SRID<span class="token punctuation">(</span>
  ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POLYGON(( -125.903320 44.668, -119.22 44.668, -119.22 50.2612, -125.903320 50.2612, -125.903320 44.668))'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token number">4326</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  <span class="token operator">*</span><span class="token punctuation">,</span> ST_AsText<span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span>  <span class="token keyword">FROM</span> places <span class="token keyword">WHERE</span> ST_CONTAINS<span class="token punctuation">(</span><span class="token variable">@polygon</span><span class="token punctuation">,</span> coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Get the result as GeoJson</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SET</span> <span class="token variable">@polygon</span> <span class="token operator">=</span> ST_SRID<span class="token punctuation">(</span>
  ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POLYGON(( </span>
<span class="token string">    -129.24316 43.16512263,</span>
<span class="token string">    -116.455078125 43.16512263,</span>
<span class="token string">    -116.455078125 52.24125614,</span>
<span class="token string">    -129.24316 52.24125614,</span>
<span class="token string">    -129.24316 43.165</span>
<span class="token string">  ))'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token number">4326</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> json_merge<span class="token punctuation">(</span>
  json_object<span class="token punctuation">(</span> <span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"FeatureCollection"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  json_object<span class="token punctuation">(</span> <span class="token string">"features"</span><span class="token punctuation">,</span> 
    json_arrayagg<span class="token punctuation">(</span>
      json_merge<span class="token punctuation">(</span>
        json_object<span class="token punctuation">(</span> <span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"Feature"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        json_object<span class="token punctuation">(</span> <span class="token string">"properties"</span><span class="token punctuation">,</span>  
          json_merge<span class="token punctuation">(</span>
            json_object<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span>
            json_object<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        json_object<span class="token punctuation">(</span><span class="token string">'geometry'</span><span class="token punctuation">,</span> ST_AsGeoJSON<span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span> 
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> places <span class="token keyword">WHERE</span> ST_CONTAINS<span class="token punctuation">(</span><span class="token variable">@polygon</span><span class="token punctuation">,</span> coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
</ul>
<h1>Postgres &#x26; PostGIS</h1>
<ul>
<li>The <code>postgis/postgis</code> image will have the following extensions installed:
<ul>
<li>postgis</li>
<li>postgis_topology</li>
<li>fuzzystrmatch</li>
<li>postgis_tiger_geocoder</li>
</ul>
</li>
</ul>
<h2>Docker stuff</h2>
<ul>
<li>Create a <code>docker-compose.yml</code> file
<div class="remark-highlight"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.4"</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">pgAdmin</span><span class="token punctuation">:</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">image</span><span class="token punctuation">:</span> dpage/pgadmin4
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8000:80"</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">PGADMIN_DEFAULT_EMAIL</span><span class="token punctuation">:</span> 1234@admin.com
      <span class="token key atrule">PGADMIN_DEFAULT_PASSWORD</span><span class="token punctuation">:</span> <span class="token number">1234</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> pgadmin<span class="token punctuation">:</span>/var/lib/pgadmin
  <span class="token key atrule">postgis</span><span class="token punctuation">:</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgis/postgis
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> <span class="token string">"postgis_container"</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"5432:5432"</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">POSTGRES_USER</span><span class="token punctuation">:</span> me
      <span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation">:</span> <span class="token number">1234</span>
      <span class="token key atrule">POSTGRES_DB</span><span class="token punctuation">:</span> letsgetspatial
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> pgvol<span class="token punctuation">:</span>/var/lib/postgresql/data
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">pgvol</span><span class="token punctuation">:</span>
  <span class="token key atrule">pgadmin</span><span class="token punctuation">:</span> 
</code></pre></div>
</li>
<li><code>docker-compose</code> commands:
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># Stop these services</span>
$ <span class="token function">docker-compose</span> stop

<span class="token comment"># Start these services</span>
$ <span class="token function">docker-compose</span> start

<span class="token comment"># Delete these services</span>
$ <span class="token function">docker-compose</span> down

<span class="token comment"># Delete all docker volumes</span>
$ <span class="token function">docker</span> volume prune
</code></pre></div>
</li>
</ul>
<h2>There are 2 ways to connect to the postgresdatabase server</h2>
<ol>
<li>PSQL</li>
</ol>
<ul>
<li>The above <code>docker-compose</code> command spins up a container that has postgres/postgis/psql installed in the container
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># Connect into the container</span>
$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it postgis_container <span class="token function">bash</span>

<span class="token comment"># Connect into postgres inside your container</span>
$ psql -d letsgetspatial -U me
</code></pre></div>
</li>
</ul>
<ol start="2">
<li>PG Admin4</li>
</ol>
<ul>
<li>The <code>docker-compose</code> command also spins up a container for <code>pgadmin4</code></li>
<li>To go to <code>pgadmin4</code> go to <code>http://localhost:8000/</code></li>
<li>User name that has been defined in the <code>docker-compose</code> is: <code>1234@admin.com</code>, and the password is <code>1234</code></li>
<li>Here you want to <code>Add new server</code> Take the below JSON data to fill in the GUI
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  generalTab<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"letsgetspatial-server"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  connectionTab<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">"host"</span><span class="token operator">:</span> <span class="token string">"postgis"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span><span class="token operator">:</span> <span class="token string">"5432"</span><span class="token punctuation">,</span>
    <span class="token property">"user"</span><span class="token operator">:</span> <span class="token string">"me"</span><span class="token punctuation">,</span>
    <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"1234"</span><span class="token punctuation">,</span>
    <span class="token property">"maintenaceDatabase"</span><span class="token operator">:</span> <span class="token string">"letsgetspatial"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>You talbles will live in <code>letsgetspatial-server</code> > <code>Databases</code> > <code>letsgetspatial</code> > <code>Schemas</code> > <code>public</code> > <code>Tables</code></li>
</ul>
<h2>Postgres commands</h2>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># List databases</span>
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token punctuation">\</span>#  <span class="token punctuation">\</span>l

<span class="token comment"># Use or switch Databases</span>
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token punctuation">\</span># <span class="token punctuation">\</span>c sales

<span class="token comment"># List tables</span>
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token punctuation">\</span># <span class="token punctuation">\</span>dt
</code></pre></div>
<h2>Postgres/PostGIS Spatial Table</h2>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> EXTENSION postgis<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> PostGIS_version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Create a table then add the spatial column</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> places <span class="token punctuation">(</span>
  id <span class="token keyword">int</span> GENERATED <span class="token keyword">BY</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">AS</span> <span class="token keyword">IDENTITY</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  name <span class="token keyword">text</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> AddGeometryColumn<span class="token punctuation">(</span><span class="token string">'places'</span><span class="token punctuation">,</span><span class="token string">'geom'</span><span class="token punctuation">,</span><span class="token string">'4326'</span><span class="token punctuation">,</span><span class="token string">'POINT'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- Add a spatial index (to drop the index ...`DROP INDEX places_geom_idx;`)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> places_geom_idx <span class="token keyword">ON</span> places <span class="token keyword">USING</span> GIST <span class="token punctuation">(</span>geom<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- Insert some data</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> places<span class="token punctuation">(</span>name<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'Portland'</span><span class="token punctuation">,</span>  ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POINT(-122.6795 45.52054)'</span><span class="token punctuation">,</span> <span class="token number">4326</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> places<span class="token punctuation">(</span>name<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'Vancouver'</span><span class="token punctuation">,</span> ST_SetSRID<span class="token punctuation">(</span>ST_MakePoint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">123.1207</span><span class="token punctuation">,</span> <span class="token number">49.2827</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4326</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> places<span class="token punctuation">(</span>name<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Seattle'</span><span class="token punctuation">,</span> ST_SetSRID<span class="token punctuation">(</span>ST_MakePoint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.33551</span><span class="token punctuation">,</span> <span class="token number">47.604311</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> places<span class="token punctuation">(</span>name<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'San Francisco'</span><span class="token punctuation">,</span> ST_SetSRID<span class="token punctuation">(</span>ST_MakePoint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">122.416534</span><span class="token punctuation">,</span> <span class="token number">37.771800273</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> places<span class="token punctuation">(</span>name<span class="token punctuation">,</span> geom<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'Ottawa'</span><span class="token punctuation">,</span> ST_SetSRID<span class="token punctuation">(</span>ST_MakePoint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">75.697174</span><span class="token punctuation">,</span> <span class="token number">45.42062</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- Get data </span>
<span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> ST_AsText<span class="token punctuation">(</span>geom<span class="token punctuation">)</span> <span class="token keyword">FROM</span> places<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> ST_AsGeoJSON<span class="token punctuation">(</span>geom<span class="token punctuation">)</span> <span class="token keyword">FROM</span> places<span class="token punctuation">;</span>


<span class="token comment">-- Distances</span>
<span class="token keyword">SELECT</span> name<span class="token punctuation">,</span>
ST_DistanceSpheroid<span class="token punctuation">(</span>
  geom<span class="token punctuation">,</span> 
  ST_SetSRID<span class="token punctuation">(</span>ST_MakePoint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">73.6049652</span><span class="token punctuation">,</span> <span class="token number">45.503459</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string">'SPHEROID["WGS84",6378137,298.257223563]'</span>
<span class="token punctuation">)</span> <span class="token keyword">FROM</span> places<span class="token punctuation">;</span>   

<span class="token keyword">SELECT</span> name <span class="token keyword">FROM</span> places
<span class="token keyword">WHERE</span> ST_DistanceSpheroid<span class="token punctuation">(</span>
  geom<span class="token punctuation">,</span> 
  ST_SetSRID<span class="token punctuation">(</span>ST_MakePoint<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">73.6049652</span><span class="token punctuation">,</span> <span class="token number">45.503459</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- montreal</span>
  <span class="token string">'SPHEROID["WGS84",6378137,298.257223563]'</span>
<span class="token punctuation">)</span> <span class="token operator">&#x3C;</span> <span class="token number">500000</span><span class="token punctuation">;</span>   


<span class="token comment">-- Tansform projections</span>
ST_Transform<span class="token punctuation">(</span>ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POINT(120.08 30.96)'</span><span class="token punctuation">,</span> <span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2163</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- Points in polygon</span>
<span class="token keyword">SELECT</span>  <span class="token operator">*</span><span class="token punctuation">,</span> ST_AsText<span class="token punctuation">(</span>geom<span class="token punctuation">)</span>  <span class="token keyword">FROM</span> places <span class="token keyword">WHERE</span> ST_CONTAINS<span class="token punctuation">(</span>
  ST_SetSRID<span class="token punctuation">(</span>
    ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POLYGON(( -125.903320 44.668, -119.22 44.668, -119.22 50.2612, -125.903320 50.2612, -125.903320 44.668))'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">4326</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  geom
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>====</p>
<h1>Firebase's Firestore</h1>
<ul>
<li>
<p>Firebase has 2 flavor of NoSQL Database <code>Realtime Database</code> &#x26; <code>Firestore Database</code></p>
</li>
<li>
<p>The <code>Realtime Database</code> as the original database before Google aquired Firebase and the <code>Firestore Database</code> is if the Realtime database &#x26; Google had a baby.</p>
</li>
<li>
<p>In most cases it's probably best to user <code>Firestore</code>, plus <code>Firestore</code> allow geo points</p>
</li>
<li>
<p>A great feature of Firebase is that you can use the <code>Emulator</code> to test out all the Firebase services locally</p>
</li>
<li>
<p>Resources</p>
<ul>
<li><a href="https://firebase.google.com/docs/emulator-suite">Firebase Emulator</a></li>
<li><a href="https://firebase.google.com/docs/firestore/query-data/get-data">Add/Get data from a DB</a></li>
<li><a href="https://firebase.google.com/docs/reference/js/v8">Firebase Reference Docs</a></li>
</ul>
</li>
<li>
<p>Initialize the Firebase application</p>
<ol>
<li>Go to the <a href="https://console.firebase.google.com/">Firebase Console</a></li>
</ol>
<ul>
<li>Create or select a project</li>
<li>Go to the <code>Firestore</code> tab in the sidebase and click <code>Create Database</code></li>
</ul>
<ol start="2">
<li>Initialize your application in your terminal</li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># just need to install the `firebase-tools` globally once</span>
$ <span class="token function">npm</span> i -g firebase-tools

$ firebase init
<span class="token comment"># Select firestore &#x26; the emulator (you can alway add/remove later)</span>
<span class="token comment"># You should have a `firebase.json` &#x26; `.firebaserc` file</span>
</code></pre></div>
<ol start="3">
<li>Install some stuff</li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">npm</span> init -y
$ <span class="token function">npm</span> i firebase-admin
$ <span class="token function">npm</span> i nodemon -D
</code></pre></div>
<ol start="4">
<li>Update your <code>package.json</code></li>
</ol>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"nodemon src"</span><span class="token punctuation">,</span>
    <span class="token property">"local:firebase"</span><span class="token operator">:</span> <span class="token string">"firebase emulators:start --import=firebase/backup --export-on-exit=firebase/backup"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>So Firebase uses configs and a <code>firebase.json</code> &#x26; <code>.firebaserc</code> file to connect your code to the project. The <code>firebase.json</code> file is absolutly fine to add you your source control because all the controls are done in the <code>firestore.rules</code> file</p>
</li>
<li>
<p>Example of a <code>firebase.json</code>:</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"firestore"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token string">"firebase/firestore.rules"</span><span class="token punctuation">,</span>
    <span class="token property">"indexes"</span><span class="token operator">:</span> <span class="token string">"firebase/firestore.indexes.json"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"emulators"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"auth"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">9099</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"firestore"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">8088</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"ui"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>Example of a <code>.firebaserc</code>:</p>
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"projects"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"&#x3C;YOUR_PROJECT_NAME>"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>
<p>When you use the <code>firebase emulators:start</code> when you close the process the data do not persist in order to persist the data you have to tell it to import/export the data add <code>--import=firebase/backup --export-on-exit=firebase/backup</code></p>
</li>
<li>
<p>Make sure you have a <code>firebase/firestore.rules</code>, these current rules anyone to read/write to the database to don't publish this</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html">rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write;
    }
  }
}
</code></pre></div>
</li>
<li>
<p>Almost time to add data... Go to your Firebase project in the Console and click the gear icon in the navbar, <code>Project settings</code> > <code>Service account</code> > <code>Generate new private key</code> copy this key to your source code <strong>MAKE SURE YOU GITIGNORE THIS FILE</strong>, this file provides admin access to your application</p>
</li>
</ul>
<h2>Admin verses Firestore/app</h2>
<ul>
<li>If you are using firebase on the client use the <code>firebase/app</code> package, if you are using Fiebase on the server where you can control your Firebase credentials use <code>firebase-admin</code></li>
<li>Exmaple of initializing a Firebase connection on the client:
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports">firebase</span> <span class="token keyword module">from</span> <span class="token string">'firebase/app'</span>
<span class="token keyword module">import</span> <span class="token string">'firebase/firestore'</span>
<span class="token keyword module">import</span> <span class="token imports">config</span> <span class="token keyword module">from</span> <span class="token string">'../config'</span>

<span class="token comment">// Only initialize the firebase app once</span>
<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>firebase<span class="token operator">?.</span>apps<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span> firebase<span class="token punctuation">.</span><span class="token method function property-access">initializeApp</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token property-access">firebase</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token method function property-access">firestore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div>
</li>
<li>Exmaple of initializing a Firebase connection on the server:
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> admin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"firebase-admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> serviceAccount <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./serviceAccountKey.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

admin<span class="token punctuation">.</span><span class="token method function property-access">initializeApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">credential</span><span class="token operator">:</span> admin<span class="token punctuation">.</span><span class="token property-access">credential</span><span class="token punctuation">.</span><span class="token method function property-access">cert</span><span class="token punctuation">(</span>serviceAccount<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> admin<span class="token punctuation">.</span><span class="token method function property-access">firestore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
</ul>
<h2>CRUD the Firestore Database</h2>
<ul>
<li><a href="https://firebase.google.com/docs/firestore/query-data/get-data">Docs</a></li>
</ul>
<h3>Add</h3>
<ul>
<li>When adding a document to a collection you can provide the id or you can let firebase create it for you</li>
<li>Here's an example of you create the document id:
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// Defining the document id explicityly</span>
<span class="token keyword">const</span> youRef <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"you-define-ids"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
youRef<span class="token punctuation">.</span><span class="token method function property-access">doc</span><span class="token punctuation">(</span><span class="token string">"some-document-id-001"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">""</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
youRef<span class="token punctuation">.</span><span class="token method function property-access">doc</span><span class="token punctuation">(</span><span class="token string">"some-document-id-002"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">""</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Let firebase define the document id</span>
<span class="token keyword">const</span> fbRed <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"firebase-define-ids"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fbRed<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">capital</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fbRed<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">capital</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fbRed<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">capital</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fbRed<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">capital</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fbRed<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">capital</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fbRed<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">capital</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
</ul>
<h3>Read</h3>
<ul>
<li>Get a specific document base of the document ID
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> docRef <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"you-define-ids"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">doc</span><span class="token punctuation">(</span><span class="token string">"some-document-id-001"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
docRef
  <span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">doc</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    doc<span class="token punctuation">.</span><span class="token property-access">exists</span> <span class="token operator">?</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Document data:"</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"No such document!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error getting document:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>Query where a value equals something
<div class="remark-highlight"><pre class="language-js"><code class="language-js">db<span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"firebase-define-ids"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">where</span><span class="token punctuation">(</span><span class="token string">"capital"</span><span class="token punctuation">,</span> <span class="token string">"=="</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">querySnapshot</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    querySnapshot<span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">doc</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// doc.data() is never undefined for query doc snapshots</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span> <span class="token string">" => "</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error getting documents: "</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>
</code></pre></div>
</li>
<li>Other queries like <code>orderBy()</code>, <code>.orderBy(&#x3C;key>, "desc")</code>, <code>limit()</code></li>
<li>If you want to query all the times a user is tagged you an array value in the document
<div class="remark-highlight"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"users"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"user1"</span><span class="token punctuation">,</span> <span class="token string">"user2"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
</li>
<li>Query the following users
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> usersRef <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersRef<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">following</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"user1"</span><span class="token punctuation">,</span> <span class="token string">"user2"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersRef<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">following</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"user1"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersRef<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">following</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"user1"</span><span class="token punctuation">,</span> <span class="token string">"user2"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersRef<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">following</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"user1"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersRef<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">following</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
usersRef<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">following</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"user3"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

usersRef
  <span class="token punctuation">.</span><span class="token method function property-access">where</span><span class="token punctuation">(</span><span class="token string">"following"</span><span class="token punctuation">,</span> <span class="token string">"array-contains-any"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"user3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">querySnapshot</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    querySnapshot<span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">doc</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span> <span class="token string">" => "</span><span class="token punctuation">,</span> doc<span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error getting documents: "</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
</ul>
<h2>Let's make it spatial!</h2>
<ul>
<li>You can do geospatial stuff with <code>firestore</code> because of geohashing</li>
<li>A geohash is a convenient way of expressing a location (anywhere in the world) using a short alphanumeric string, with greater precision obtained with longer strings.</li>
<li>A geohash actually identifies a rectangular cell: at each level, each extra character identifies one of 32 sub-cells.</li>
<li><img src="/assets/blog/geo/geohash.jpg" alt="geohash"></li>
<li><a href="https://www.movable-type.co.uk/scripts/geohash.html">Read more on geohashes</a></li>
<li>Vancouver, BC has coordinates of 49.2827° N, 123.1207° W and the geohash would be <a href="http://geohash.org/c2b2q7dhx"><code>c2b2q7dhx</code></a></li>
</ul>
<h3>Using <code>geofirestore</code></h3>
<ul>
<li>
<p><a href="https://geofirestore.com/">geofirestore docs</a></p>
</li>
<li>
<p>As of 09-2021 <code>geofirestore</code> only supports up to <code>firebase</code> v8</p>
</li>
<li>
<p>When using <code>geofirestore</code> all you need to provide in the document is a <code>coordinates: new firebase.firestore.GeoPoint(&#x3C;lat>, &#x3C;lng>)</code> property. Geofirestore will take this GeoPoint and create a geohash from it</p>
</li>
<li>
<p><strong>NOTE</strong> you can still query your collection with the regular Friebase querys however you now have the option to do some limited spatial queries</p>
</li>
<li>
<p>Setup</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// Firebase v8</span>
<span class="token comment">/*</span>
<span class="token comment">import firebase from 'firebase/app';</span>
<span class="token comment">import 'firebase/firestore';</span>
<span class="token comment">import * as geofirestore from 'geofirestore';</span>
<span class="token comment">*/</span>

<span class="token comment">// *NOTE: Firebase v9 ( Currently geofirebase library only works with the Firebase Compat library. Support for the Firebase Modular library is coming down the road.)</span>
<span class="token keyword module">import</span> <span class="token imports">firebase</span> <span class="token keyword module">from</span> <span class="token string">'firebase/compat/app'</span>
<span class="token keyword module">import</span> <span class="token string">'firebase/compat/firestore'</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> geofirestore</span> <span class="token keyword module">from</span> <span class="token string">'geofirestore'</span>

<span class="token comment">// Initialize the Firebase SDK</span>
firebase<span class="token punctuation">.</span><span class="token method function property-access">initializeApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create a Firestore reference</span>
<span class="token keyword">const</span> firestore <span class="token operator">=</span> firebase<span class="token punctuation">.</span><span class="token method function property-access">firestore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create a GeoFirestore reference</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">GeoFirestore</span> <span class="token operator">=</span> geofirestore<span class="token punctuation">.</span><span class="token method function property-access">initializeApp</span><span class="token punctuation">(</span>firestore<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Create a GeoCollection reference</span>
<span class="token keyword">const</span> geocollection <span class="token operator">=</span> <span class="token maybe-class-name">GeoFirestore</span><span class="token punctuation">.</span><span class="token method function property-access">collection</span><span class="token punctuation">(</span><span class="token string">'restaurants'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Add a point to the collection</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token comment">// Add a document to the collection containing `coordinates` key</span>
<span class="token keyword">const</span> uuid <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
geocollection<span class="token punctuation">.</span><span class="token method function property-access">doc</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">coordinates</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">firestore<span class="token punctuation">.</span>firestore<span class="token punctuation">.</span>GeoPoint</span><span class="token punctuation">(</span><span class="token number">42.3547255</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71.0549425</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// YOU NEED THIS LINE</span>
  <span class="token literal-property property">geojson</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"Feature"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"Point"</span><span class="token punctuation">,</span> <span class="token literal-property property">coordinates</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">71.0549425</span><span class="token punctuation">,</span> <span class="token number">42.3547255</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      uuid<span class="token punctuation">,</span>
      <span class="token literal-property property">uid</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"user1_000"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// This allows you to filter by multiple users</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"Starbucks"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">"211 Congress St,Boston, MA 02210"</span><span class="token punctuation">,</span>
      <span class="token literal-property property">rating</span><span class="token operator">:</span> <span class="token number">3.5</span><span class="token punctuation">,</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">"https://s3-media4.fl.yelpcdn.com/bphoto/AVDfFF1OaqiNDqeg-Z2xEQ/o.jpg"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Query the collection</p>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">findNearest</span><span class="token punctuation">(</span><span class="token parameter">point<span class="token punctuation">,</span> radiusInKm<span class="token punctuation">,</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> limit <span class="token operator">=</span> <span class="token number">100</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Create a GeoQuery based on a location</span>
  <span class="token keyword">const</span> center <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">firestore<span class="token punctuation">.</span>firestore<span class="token punctuation">.</span>GeoPoint</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span><span class="token property-access">lat</span><span class="token punctuation">,</span> point<span class="token punctuation">.</span><span class="token property-access">lng</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// perform the query</span>
  <span class="token keyword">const</span> query <span class="token operator">=</span> geocollection
    <span class="token punctuation">.</span><span class="token method function property-access">near</span><span class="token punctuation">(</span><span class="token punctuation">{</span> center<span class="token punctuation">,</span> <span class="token literal-property property">radius</span><span class="token operator">:</span> radiusInKm <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//</span>
    <span class="token punctuation">.</span><span class="token method function property-access">where</span><span class="token punctuation">(</span><span class="token string">"geojson.properties.uid"</span><span class="token punctuation">,</span> <span class="token string">"array-contains-any"</span><span class="token punctuation">,</span> users<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">limit</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword control-flow">await</span> query<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Cleanup the data</span>
  <span class="token keyword">const</span> results <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token property-access">docs</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> geojson<span class="token punctuation">,</span> g <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>geojson<span class="token punctuation">,</span> <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>geojson<span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">,</span> <span class="token literal-property property">geohash</span><span class="token operator">:</span> g<span class="token punctuation">.</span><span class="token property-access">geohash</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"[length]"</span><span class="token punctuation">,</span> results<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> results<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">findNearest</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">42.3461</span><span class="token punctuation">,</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">71.0974</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"user3_000"</span><span class="token punctuation">,</span> <span class="token string">"user1_000"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</li>
<li>
<p>Query nearest &#x26; property value</p>
</li>
</ul>
<div class="remark-highlight"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> geocollection<span class="token operator">:</span> GeoCollectionReference <span class="token operator">=</span> geofirestore<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'Users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> centerCoords <span class="token operator">=</span> <span class="token punctuation">{</span> lat<span class="token operator">:</span> <span class="token number">42.3461</span><span class="token punctuation">,</span> lng<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">71.0974</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> geoQuery <span class="token operator">=</span> geocollection<span class="token punctuation">.</span><span class="token function">near</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    center<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">firebase</span><span class="token punctuation">.</span>firestore<span class="token punctuation">.</span><span class="token function">GeoPoint</span><span class="token punctuation">(</span>centerCoords<span class="token punctuation">.</span>lat<span class="token punctuation">,</span>centerCoords<span class="token punctuation">.</span>lng<span class="token punctuation">)</span><span class="token punctuation">,</span>
    radius<span class="token operator">:</span> <span class="token number">10.5</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'coffee'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>====</p>
<h1>DynamoDB</h1>
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Operations_Amazon_DynamoDB.html">DynamoDB API Reference</a></li>
<li><a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB.html">DynamoDB Class list</a></li>
<li>DynamoDB is a hosted NoSQL database offered by Amazon Web Services (AWS). It offers:
<ul>
<li>Reliable performance even as it scales;</li>
<li>Managed experience, so you won't be SSH-ing into servers to upgrade the crypto libraries;</li>
<li>Small, simple API allowing for simple key-value access as well as more advanced query patterns.</li>
</ul>
</li>
<li>It works extremely well with Serverless applications (API Gateway &#x26; Lambda functions)</li>
<li>Dynamodb you work with <code>tables</code>, <code>attributes</code>, &#x26; <code>items</code>. Each table needs to have a <code>Primary Key</code> which is a special attribute that is unique or a <code>Primary Key + Sort Key</code> aka <code>Composite Primary Key</code>.</li>
<li><code>Primary Key</code> or <code>Partition Key</code>is just that, a unique attribute to which you can query on it also allows</li>
<li>The  <code>Primary Key + Sort Key</code> is a combination of 2 attributes when used together makes a unique identificator. It allows for id flexibility</li>
<li>In addition to <code>primary key</code> there's also <code>Secondary Indexes</code> where that allows you to query the table data with an alternate key. There are 2 kinds of secondary indexes:
<ul>
<li>Global Secondary Index: another index partion &#x26; sort keys that differ from the primary &#x26; sort key</li>
<li>Local Secondary Index: similar partition key but different sort key</li>
</ul>
</li>
<li>The basic Dynamodb API consist of:
<ul>
<li>PutItem (Create)</li>
<li>BatchWriteItem (Create)</li>
<li>GetItem (Read)</li>
<li>BatchGetItem (Read)</li>
<li>Query (Read)</li>
<li>Scan (Read)</li>
<li>UpdateItem (Update)</li>
<li>DeleteItem (Delete)</li>
<li>BatchWriteItem (Delete)</li>
</ul>
</li>
<li><code>Global tables</code> provide a solution for deploying a multi-region, multi-master database, without having to build and maintain your own replication solution.</li>
<li><code>Time To Live (TTL)</code>, allows you to define when items in a table expire so that they can be automatically deleted from the database.</li>
<li>When you create a table in DynamoDB you need to specify the throughput capacity for read/write capacity unit
<ul>
<li>One read capacity unit represents one strongly consistent read per second, for an item up to 4 KB in size.</li>
</ul>
</li>
<li>When reading the data in the database you can do <code>scan</code> or <code>queries</code>. A Scan operation reads every item in a table or a secondary index. By default, a Scan operation returns all of the data attributes for every item in the table or index.</li>
<li>You can also encrypt the data in the database</li>
<li>You can also add automated tools for monitoring with CloudWatch Alarms, Logs, Events</li>
</ul>
<h2>Anatomy of an Item</h2>
<ul>
<li>When setting an attribute for a DynamoDB item, you must specify the Data Type (Scalar, Documents, &#x26; Sets) of the attribute.</li>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_AttributeValue.html">AWS Dynamodb API Attribute Values</a></li>
<li>Data Types:
<ul>
<li><strong>Scalar</strong> Data Types:
<ul>
<li><code>Numbers</code> (N) − They are limited to 38 digits, and are either positive, negative, or zero.</li>
<li><code>String</code> (S) − They are Unicode using UTF-8, with a minimum length of >0 and maximum of 400KB.</li>
<li><code>Binary</code> (B) − They store any binary data, e.g., encrypted data, images, and compressed text. DynamoDB views its bytes as unsigned.</li>
<li><code>Boolean</code> (BOOL) − They store true or false.</li>
<li><code>Null</code> (NULL) − They represent an unknown or undefined state.</li>
</ul>
</li>
<li><strong>Document</strong> Data Types:
<ul>
<li><code>List</code> (L) − It stores ordered value collections, and uses square ([...]) brackets.</li>
<li><code>Map</code> (M) − It stores unordered name-value pair collections, and uses curly ({...}) braces.</li>
</ul>
</li>
<li><strong>Set</strong> Data Type:
<ul>
<li>Available Attribute values: B(S|NS|SS)</li>
<li>Must contain elements of the same type whether number, string, or binary. The only limits placed on sets consist of the 400KB item size limit, and each element being unique.</li>
</ul>
</li>
</ul>
</li>
<li>Here's an example of the Data Types:
<div class="remark-highlight"><pre class="language-html"><code class="language-html">{
    "Name": { "S": "Alex DeBrie" },
    "Age": { "N": "29" },
    "Roles": { "L": [{ "S": "Admin" }, { "S": "User" }] }
}
</code></pre></div>
</li>
<li>When creating a new table you need: [<code>AttributeDefinitions</code>, <code>KeySchema</code>, <code>ProvisionedThroughput</code>, <code>TableName</code>, &#x26; <code>StreamSpecification</code>]</li>
</ul>
<h2>Defining a table's</h2>
<ul>
<li><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.CreateTable.html">AWS Docs example on how to CRUD a table</a></li>
<li><a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-dynamodb/index.html">Node.js <code>@aws-sdk/client-dynamodb</code> reference</a></li>
<li>When creating a new table you need to define the primary key (partion and/or sort key)</li>
<li>Every item in a table is uniquely identified by its primary key.</li>
<li>Key schema: (HASH|RANGE) (Partition|Sort key)
<img src="/assets/blog/database/aws-table-hash-range.png" alt=""></li>
<li><code>HASH</code> is for you primary key and <code>RANGE</code> is for when you use a composity key</li>
<li>You can create a data and it's configuration via the AWS Console, aws-cli, or with code</li>
</ul>
<h2>Local development</h2>
<ul>
<li>
<p>You can run DynamoDB locally with <a href="https://hub.docker.com/r/amazon/dynamodb-local/">AWS official docker container</a></p>
</li>
<li>
<p>You will also need the <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI</a> installed on your computer</p>
<ul>
<li>Setup your aws config add this to your <code>~/.aws/credentials</code> file:
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token punctuation">[</span>local-dev<span class="token punctuation">]</span>
aws_access_key_id <span class="token operator">=</span> fakeMyKeyId
aws_secret_access_key <span class="token operator">=</span> fakeSecretAccessKey
region <span class="token operator">=</span> ap-southeast-2
</code></pre></div>
</li>
<li>This will allows us to pick the profile we want for local development</li>
</ul>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/cli/latest/reference/dynamodb/index.html">DynamoDB AWS CLI commands here</a></p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/workbench.html">NoSQL Workbench</a> for Amazon DynamoDB</p>
</li>
<li>
<p>Create a <code>docker-compose.yml</code> file (In order to make this local-dynamodb work with NoSQL Workbench you have to provide the <code>-sharedDb</code> flag). <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.UsageNotes.html">More on the shared flag here</a> or <a href="https://stackoverflow.com/questions/63835658/can-not-find-table-using-nosql-workbench-for-dynamodb-when-connecting-to-dynamod">stackoverflow</a></p>
<div class="remark-highlight"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">local-dynamo</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> amazon/dynamodb<span class="token punctuation">-</span>local
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>jar DynamoDBLocal.jar <span class="token punctuation">-</span>sharedDb <span class="token punctuation">-</span>dbPath .
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> dynamodb<span class="token punctuation">-</span>local
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span>
</code></pre></div>
</li>
<li>
<p>Run the local database!</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">docker-compose</span> up
</code></pre></div>
</li>
<li>
<p>Create a table with the Terminal</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token comment"># Create the DynamoDB table. (make sure to pass in the `--profile`)</span>
$ aws dynamodb create-table <span class="token punctuation">\</span>
    --profile local-dev <span class="token punctuation">\</span>
    --table-name WeatherForecast <span class="token punctuation">\</span>
    --attribute-definitions <span class="token punctuation">\</span>
        <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>City,AttributeType<span class="token operator">=</span>S <span class="token punctuation">\</span>
        <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>Date,AttributeType<span class="token operator">=</span>S <span class="token punctuation">\</span>
    --key-schema <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>City,KeyType<span class="token operator">=</span>HASH <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>Date,KeyType<span class="token operator">=</span>RANGE <span class="token punctuation">\</span>
    --provisioned-throughput <span class="token assign-left variable">ReadCapacityUnits</span><span class="token operator">=</span><span class="token number">1</span>,WriteCapacityUnits<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span>
    --endpoint-url http://localhost:8000

<span class="token comment"># list all the tables </span>
$ aws dynamodb list-tables --profile local-dev --endpoint-url http://localhost:8000
</code></pre></div>
</li>
<li>
<p>NoSQL Workbench Steps:</p>
<ul>
<li>Create a DB connection</li>
<li><code>Operation builder</code> > <code>+ Add connection</code> > <code>DynamoDB local</code> > provide connection name &#x26; port
<img src="/assets/blog/database/aws-workbench-db-connection.jpg" alt="aws-workbench-db-connection"></li>
</ul>
<p><img src="/assets/blog/database/aws-workbench-local-dynamodb-setup-active-connection.jpg" alt="aws-workbench-local-dynamodb-setup-active-connection">
<img src="/assets/blog/database/aws-workbench-local-dynamodb-active-connection.jpg" alt="aws-workbench-local-dynamodb-active-connection"></p>
<ul>
<li>Now you can use the "Data Modeler" to create a model the
<img src="/assets/blog/database/aws-workbench-create-table.jpg" alt="aws-workbench-create-table"></li>
</ul>
</li>
</ul>
<h2>Different ways to create a Dynamodb Table</h2>
<h3>Create a Dynamodb table using <code>aws-cli</code></h3>
<p><img src="/assets/blog/database/aws-console-dynamo.jpg" alt="aws-console-dynamo"></p>
<h3>Create a Dynamodb table using <code>aws-cli</code></h3>
<ul>
<li>Here's an exmaple using the <code>aws-cli</code>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token assign-left variable">DYNAMODB_TABLE_NAME</span><span class="token operator">=</span><span class="token string">"TableWithPartionAndSortKey"</span>
$ <span class="token assign-left variable">AWS_PROFILE</span><span class="token operator">=</span><span class="token string">"local-dev"</span>

<span class="token comment"># Just a partion-key</span>
$ aws dynamodb create-table <span class="token punctuation">\</span>
      --profile <span class="token variable">$AWS_PROFILE</span> <span class="token punctuation">\</span>
      --table-name <span class="token variable">$DYNAMODB_TABLE_NAME</span> <span class="token punctuation">\</span>
      --attribute-definitions <span class="token punctuation">\</span>
          <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>title,AttributeType<span class="token operator">=</span>S <span class="token punctuation">\</span>
      --key-schema <span class="token punctuation">\</span>
        <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>title,KeyType<span class="token operator">=</span>HASH <span class="token punctuation">\</span>
      --provisioned-throughput <span class="token assign-left variable">ReadCapacityUnits</span><span class="token operator">=</span><span class="token number">1</span>,WriteCapacityUnits<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span>
      --endpoint-url http://localhost:8000

<span class="token comment"># If you want to use partition &#x26; sort key</span>
$ aws dynamodb create-table <span class="token punctuation">\</span>
      --profile <span class="token variable">$AWS_PROFILE</span> <span class="token punctuation">\</span>
      --table-name <span class="token variable">$DYNAMODB_TABLE_NAME</span> <span class="token punctuation">\</span>
      --attribute-definitions <span class="token punctuation">\</span>
          <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>title,AttributeType<span class="token operator">=</span>S <span class="token punctuation">\</span>
          <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>date,AttributeType<span class="token operator">=</span>S <span class="token punctuation">\</span>
      --key-schema <span class="token punctuation">\</span>
        <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>title,KeyType<span class="token operator">=</span>HASH <span class="token punctuation">\</span>
        <span class="token assign-left variable">AttributeName</span><span class="token operator">=</span>date,KeyType<span class="token operator">=</span>RANGE <span class="token punctuation">\</span>
      --provisioned-throughput <span class="token assign-left variable">ReadCapacityUnits</span><span class="token operator">=</span><span class="token number">1</span>,WriteCapacityUnits<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span>
      --endpoint-url http://localhost:8000
$ aws dynamodb list-tables --profile local-dev --endpoint-url http://localhost:8000
</code></pre></div>
</li>
</ul>
<h3>Create a Dynamodb with NoSQL Workbench</h3>
<ul>
<li>You can connect and use the stand-alone <a href="https://www.amazonaws.cn/en/dynamodb/nosql-workbench/">NoSQL Workbench</a> application to add/edit/delete tables in multiple accounts
<img src="/assets/blog/database/aws-nosql-workbench.jpg" alt="aws-nosql-workbench"></li>
</ul>
<h3>Create a Dynamodb table using javascript</h3>
<ul>
<li>
<p><em>NOTE:</em> <code>aws-sdk</code> is the v2 (~62 MB) (2022-09-11 ~9,816,781 weekly downloads) is was most people current used. v3 <code>@aws-sdk/client-dynamodb</code> (~4.5 MB)(2022-09-11 ~471,785 weekly downloads, not really a fair comparison but just wanted to give you a scale) which is more modular which will decrease package size and increase performance. Along with the client package you will want to use <code>@aws-sdk/lib-dynamodb</code> to do all the CRUD opperations on your table.</p>
</li>
<li>
<p>Let's CRUD a Dynamodb table with the <code>v2</code> version <code>aws-sdk</code>. <em>Note:</em> <code>aws-sdk</code> also works with ESM modules.</p>
<ol>
<li>Init a project</li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> init
$ <span class="token function">yarn</span> <span class="token function">add</span> aws-sdk dotenv
$ <span class="token function">mkdir</span> src
$ <span class="token function">touch</span> src/index.js src/db.js src/config.js .env
</code></pre></div>
<ol start="2">
<li><code>.env</code></li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">AWS_ACCESS_KEY <span class="token operator">=</span> <span class="token string">"fakeMyKeyId"</span>
AWS_SECRET_KEY <span class="token operator">=</span> <span class="token string">"fakeSecretAccessKey"</span>
AWS_REGION <span class="token operator">=</span> <span class="token string">"local"</span>
</code></pre></div>
<ol start="3">
<li><code>./src/config.js</code></li>
</ol>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"dotenv"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">aws</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">config</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">region</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">AWS_REGION</span><span class="token punctuation">,</span>
      <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">accessKeyId</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">AWS_ACCESS_KEY</span><span class="token punctuation">,</span>
        <span class="token literal-property property">secretAccessKey</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">AWS_SECRET_KEY</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">endpoint</span><span class="token operator">:</span> <span class="token string">"http://localhost:8000"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> config<span class="token punctuation">;</span>
</code></pre></div>
<ol start="4">
<li><code>./src/db.js</code></li>
</ol>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token constant">AWS</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"aws-sdk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./config.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token constant">AWS</span><span class="token punctuation">.</span><span class="token property-access">config</span><span class="token punctuation">.</span><span class="token method function property-access">update</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token property-access">aws</span><span class="token punctuation">.</span><span class="token property-access">config</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">DynamoDB</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AWS<span class="token punctuation">.</span>DynamoDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token string">"Movies"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">KeySchema</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">AttributeName</span><span class="token operator">:</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token literal-property property">KeyType</span><span class="token operator">:</span> <span class="token string">"HASH"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// Only using partition-key</span>
    <span class="token literal-property property">AttributeDefinitions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">AttributeName</span><span class="token operator">:</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token literal-property property">AttributeType</span><span class="token operator">:</span> <span class="token string">"S"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ProvisionedThroughput</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">ReadCapacityUnits</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token literal-property property">WriteCapacityUnits</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">createTable</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Unable to create table"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Created table"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">addMovie</span><span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> rtScore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Item</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">S</span><span class="token operator">:</span> title <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">rtScore</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">N</span><span class="token operator">:</span> rtScore <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">putItem</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Added "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" with a Rotten Tomatoes Score of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rtScore<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Unable to add movie"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getAllMovies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">scan</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> data<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Items</span></span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token constant">AWS</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">DynamoDB</span></span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Converter</span></span><span class="token punctuation">.</span><span class="token method function property-access">unmarshall</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMovie</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Key</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">S</span><span class="token operator">:</span> title <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">getItem</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token constant">AWS</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">DynamoDB</span></span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Converter</span></span><span class="token punctuation">.</span><span class="token method function property-access">unmarshall</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Item</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateMovieScore</span><span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> newRtScore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Item</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">S</span><span class="token operator">:</span> title <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">rtScore</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">N</span><span class="token operator">:</span> newRtScore<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">putItem</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Updated "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" with a Rotten Tomatoes Score of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newRtScore<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Unable to update movie"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">deleteMovie</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Key</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token constant">S</span><span class="token operator">:</span> title <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">deleteItem</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Deleted </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Unable to find movie"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> error<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  createTable<span class="token punctuation">,</span>
  addMovie<span class="token punctuation">,</span>
  getAllMovies<span class="token punctuation">,</span>
  getMovie<span class="token punctuation">,</span>
  updateMovieScore<span class="token punctuation">,</span>
  deleteMovie<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>
<ol start="5">
<li>Run some commands</li>
</ol>
<ul>
<li>
<p>Create a table</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").createTable()'</span>
</code></pre></div>
</li>
<li>
<p>CRUD the table</p>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").addMovie("The Fast and the Furious", "100")'</span>
$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").getAllMovies()'</span>
$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").updateMovieScore("The Fast and the Furious", 53)'</span>
$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").getMovie("The Fast and the Furious")'</span>
$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").deleteMovie("The Fast and the Furious")'</span>
$ <span class="token function">node</span> -e <span class="token string">'require("./src/db.js").getAllMovies()'</span>
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Let's create a table with v3<a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.CreateTable.html">aws docs example</a>:</p>
</li>
<li>
<p><em>NOTE:</em> when working with the v3 version you don't have to use DynamoDB Object for the <code>Item</code> property for the params, just work with regular JSON</p>
</li>
<li>
<p><em>NOTE:</em> Below example uses aws <code>profile</code> instead of <code>credentials.accessKeyId</code> &#x26; <code>credentials.AWS_ACCESS_KEY</code> but profile will also work</p>
</li>
<li>
<p>Let's CRUD a Dynamodb table with the <code>v3</code> version <code>@aws-sdk/lib-dynamodb</code>.</p>
<ol>
<li>Init a project</li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">yarn</span> init
$ <span class="token function">yarn</span> <span class="token function">add</span> @aws-sdk/client-dynamodb @aws-sdk/lib-dynamodb dotenv
$ <span class="token function">mkdir</span> src
$ <span class="token function">touch</span> src/index.js src/db.js src/config.js .env
</code></pre></div>
<ol start="2">
<li><code>.env</code></li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell"><span class="token assign-left variable">AWS_PROFILE</span><span class="token operator">=</span> <span class="token string">"local-dev"</span>
AWS_REGION <span class="token operator">=</span> <span class="token string">"local"</span>
</code></pre></div>
<ol start="3">
<li><code>./src/config.js</code></li>
</ol>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> dotenv</span> <span class="token keyword module">from</span> <span class="token string">"dotenv"</span><span class="token punctuation">;</span>
dotenv<span class="token punctuation">.</span><span class="token method function property-access">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">aws</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">config</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">profile</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">AWS_PROFILE</span><span class="token punctuation">,</span>
      <span class="token literal-property property">region</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">AWS_REGION</span><span class="token punctuation">,</span>
      <span class="token literal-property property">endpoint</span><span class="token operator">:</span> <span class="token string">"http://localhost:8000"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword module">export</span> <span class="token keyword module">default</span> config<span class="token punctuation">;</span>
</code></pre></div>
<ol start="3">
<li><code>src/db.js</code></li>
</ol>
<div class="remark-highlight"><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">DynamoDBClient</span><span class="token punctuation">,</span> <span class="token maybe-class-name">CreateTableCommand</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"@aws-sdk/client-dynamodb"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">PutCommand</span><span class="token punctuation">,</span> <span class="token maybe-class-name">GetCommand</span><span class="token punctuation">,</span> <span class="token maybe-class-name">ScanCommand</span><span class="token punctuation">,</span> <span class="token maybe-class-name">QueryCommand</span><span class="token punctuation">,</span> <span class="token maybe-class-name">DeleteCommand</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"@aws-sdk/lib-dynamodb"</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports">config</span> <span class="token keyword module">from</span> <span class="token string">"./config.js"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token string">"MoviesV3"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token maybe-class-name">DynamoDB</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DynamoDBClient</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token property-access">aws</span><span class="token punctuation">.</span><span class="token property-access">config</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createTable</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">KeySchema</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">AttributeName</span><span class="token operator">:</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token literal-property property">KeyType</span><span class="token operator">:</span> <span class="token string">"HASH"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// Only using partition-key</span>
    <span class="token literal-property property">AttributeDefinitions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">AttributeName</span><span class="token operator">:</span> <span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token literal-property property">AttributeType</span><span class="token operator">:</span> <span class="token string">"S"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ProvisionedThroughput</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">ReadCapacityUnits</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">WriteCapacityUnits</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">StreamSpecification</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">StreamEnabled</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CreateTableCommand</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Table Created"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">addMovie</span><span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> rtScore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token comment">// Don't pass in Dynamodb Object, pass in JSON</span>
    <span class="token literal-property property">Item</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> title<span class="token punctuation">,</span>
      <span class="token literal-property property">rtScore</span><span class="token operator">:</span> rtScore<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PutCommand</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Added "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" with a Rotten Tomatoes Score of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rtScore<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Unable to add movie"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getAllMovies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ScanCommand</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Success :"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Items</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMovie</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Key</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetCommand</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Success :"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Item</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateMovieScore</span><span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> rtScore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Item</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> title<span class="token punctuation">,</span>
      <span class="token literal-property property">rtScore</span><span class="token operator">:</span> rtScore<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PutCommand</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Updated "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" with a Rotten Tomatoes Score of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rtScore<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Unable to update movie"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">deleteMovie</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">TableName</span><span class="token operator">:</span> <span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>
    <span class="token literal-property property">Key</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">DynamoDB</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DeleteCommand</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Successfully deleted :"</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ol start="4">
<li>CRUD the DB</li>
</ol>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.createTable())'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.addMovie("The Fast and the Furious", 100));'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.getAllMovies())'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.getMovie("The Fast and the Furious"))'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.updateMovieScore("The Fast and the Furious", 53))'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.getMovie("The Fast and the Furious"))'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.deleteMovie("The Fast and the Furious"))'</span>
$ <span class="token function">node</span> -e <span class="token string">'import("./src/db.js").then(db => db.getAllMovies())'</span>
</code></pre></div>
</li>
</ul>
<h2>Query the database</h2>
<ul>
<li>
<p><a href="https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html">Dynamodb Query Docs</a></p>
</li>
<li>
<p>All the Dynamodb functions above have been done with the exact partition key, you can query the data in the database especially if you use the <code>Sort-key</code>. If you are using the sort-key you can preform stronger queries on that key like greater/less-than/between/begins-with</p>
</li>
<li>
<p>Valid equality test for <code>partition-key</code> only:</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html">partitionKeyName = :partitionkeyval
</code></pre></div>
</li>
<li>
<p>Valid <code>Partition-key</code> &#x26; <code>Sort-key</code></p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html">partitionKeyName = :partitionkeyval AND sortKeyName = :sortkeyval
</code></pre></div>
</li>
<li>
<p>Valid comparisons for the sort key condition are as follows:</p>
<div class="remark-highlight"><pre class="language-html"><code class="language-html">sortKeyName = :sortkeyva
sortKeyName &#x3C; :sortkeyva
sortKeyName &#x3C;= :sortkeyval 
sortKeyName > :sortkeyva
sortKeyName >= :sortkeyval
sortKeyName BETWEEN :sortkeyval1 AND :sortkeyval2 
begins_with ( sortKeyName, :sortkeyval )
</code></pre></div>
</li>
</ul>
<h2>batch load a json file</h2>
<div class="remark-highlight"><pre class="language-shell"><code class="language-shell">$ aws dynamodb batch-write-item --request-items file://my-data-seed.json --profile local-dev
</code></pre></div>
<h2>Single table design</h2>
<ul>
<li>You can create a single table design using a primary key with a specific pattern.</li>
</ul>
<h3></h3>
</div></div></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"><div class="py-28 flex flex-col lg:flex-row items-center"><div class="flex flex-col lg:flex-row justify-center items-center lg:pl-4 lg:w-1/2"><a href="/">Learn something else</a></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Databases","slug":"databases","content":"\u003ch1\u003eDatabases\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e[x] MySQL + baked in spatial functions\u003c/li\u003e\n\u003cli\u003e[x] PostgreSQL + PostGIS\u003c/li\u003e\n\u003cli\u003e[x] Firebase\u003c/li\u003e\n\u003cli\u003e[x] DynamoDB\u003c/li\u003e\n\u003cli\u003e[ ] SQLite + SpatiaLite\u003c/li\u003e\n\u003cli\u003e[ ] MongoDB\u003c/li\u003e\n\u003cli\u003e[ ] CouchDB\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eMySQL\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eBasic Docker stuff\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# show all running containers\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token function\"\u003eps\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# Show all stoped containers\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token function\"\u003eps\u003c/span\u003e -a\n\n\u003cspan class=\"token comment\"\u003e# Pull the latest image\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e pull mysql/mysql-server:latest\n\n\u003cspan class=\"token comment\"\u003e# Create \u0026#x26; run a container\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e run --name some-mysql -p \u003cspan class=\"token number\"\u003e3306\u003c/span\u003e:3306  -e \u003cspan class=\"token assign-left variable\"\u003eMYSQL_ROOT_PASSWORD\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e123456789\u003c/span\u003e -d mysql\n\n\u003cspan class=\"token comment\"\u003e# stop/start\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e stop some-mysql\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e start some-mysql\n\n\n\u003cspan class=\"token comment\"\u003e# Docker cleanups\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e system prune\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e image prune\n\n\u003cspan class=\"token comment\"\u003e# Create a database dump\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexec\u003c/span\u003e some-mysql \u003cspan class=\"token function\"\u003esh\u003c/span\u003e -c \u003cspan class=\"token string\"\u003e'exec mysqldump --all-databases -uroot -p\"$MYSQL_ROOT_PASSWORD\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e /some/path/on/your/host/all-databases.sql\n\n\u003cspan class=\"token comment\"\u003e# Restoring data from a dump file\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexec\u003c/span\u003e -i some-mysql \u003cspan class=\"token function\"\u003esh\u003c/span\u003e -c \u003cspan class=\"token string\"\u003e'exec mysql -uroot -p\"$MYSQL_ROOT_PASSWORD\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e /some/path/on/your/host/all-databases.sql\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eConnecting to your Database (MySQL v8)\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eFirst spin up a docker container\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# Pull the latest image\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e pull mysql/mysql-server:latest\n\n\u003cspan class=\"token comment\"\u003e# Create \u0026#x26; run a container\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e run --name some-mysql -p \u003cspan class=\"token number\"\u003e3306\u003c/span\u003e:3306 -p \u003cspan class=\"token number\"\u003e33060\u003c/span\u003e:33060  -e \u003cspan class=\"token assign-left variable\"\u003eMYSQL_ROOT_PASSWORD\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e123456789\u003c/span\u003e -d mysql\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexec\u003c/span\u003e -it some-mysql mysql -uroot -p\nmysql\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e CREATE DATABASE letsgetspatial\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eConnecting to the \u003ccode\u003eMySQL v8\u003c/code\u003e Database with \u003ca href=\"https://marketplace.visualstudio.com/items?itemName=mtxr.sqltools\"\u003e\u003ccode\u003eSQLTools\u003c/code\u003e extension\u003c/a\u003e. You will also have to download the Extensions drivers: MySQL\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eNOTE\u003c/em\u003e we had to make a database \u003ccode\u003eletsgetspatial\u003c/code\u003e manually above\u003c/li\u003e\n\u003cli\u003eAdd the connection config to your \u003ccode\u003e./.vscode/settings.json\u003c/code\u003e file\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"sqltools.connections\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"mysqlOptions\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"authProtocol\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"xprotocol\"\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"previewLimit\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e50\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"server\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"localhost\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"port\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e33060\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"driver\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"MySQL\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"MySQL_v8\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"database\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"letsgetspatial\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"username\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"root\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"password\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"123456789\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"connectionTimeout\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e15\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cimg src=\"/assets/blog/database/vscode-sqltools.jpg\" alt=\"vscode-sqltools\"\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eClick the \u003ccode\u003eTest Connection\u003c/code\u003e (it kinda appears like a white rectanglar button)\u003c/li\u003e\n\u003cli\u003eUnder the \u003ccode\u003eConnection\u003c/code\u003e section in the side panel click this \u003ccode\u003esome-mysql\u003c/code\u003e connection and it will open up a sql window where you can write queries\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e--\u003c/code\u003e to write comments \u0026#x26; \u003ccode\u003e-- @block\u003c/code\u003e to write blocks that you can execute only the block\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBacking up data\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# Create a database dump\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexec\u003c/span\u003e some-mysql \u003cspan class=\"token function\"\u003esh\u003c/span\u003e -c \u003cspan class=\"token string\"\u003e'exec mysqldump --all-databases -uroot -p\"$MYSQL_ROOT_PASSWORD\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e /some/path/on/your/host/all-databases.sql\n\n\u003cspan class=\"token comment\"\u003e# Restoring data from a dump file\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexec\u003c/span\u003e -i some-mysql \u003cspan class=\"token function\"\u003esh\u003c/span\u003e -c \u003cspan class=\"token string\"\u003e'exec mysql -uroot -p\"$MYSQL_ROOT_PASSWORD\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e /some/path/on/your/host/all-databases.sql\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDocker Compose way\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWhere gonna use \u003ccode\u003edocker-compose\u003c/code\u003e to make our lives easier\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a \u003ccode\u003edocker-compose.yml\u003c/code\u003e files with:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-yml\"\u003e\u003ccode class=\"language-yml\"\u003e\u003cspan class=\"token key atrule\"\u003eversion\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'3.3'\u003c/span\u003e\n\u003cspan class=\"token key atrule\"\u003eservices\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003edb\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e mysql\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003elatest\n    \u003cspan class=\"token key atrule\"\u003erestart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e always\n    \u003cspan class=\"token key atrule\"\u003eenvironment\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003eMYSQL_DATABASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'letsgetspatial'\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# So you don't have to use root, but you can if you like\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003eMYSQL_USER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# You can use whatever password you like\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003eMYSQL_PASSWORD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'password'\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# Password for root access\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003eMYSQL_ROOT_PASSWORD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'password'\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# \u0026#x3C;Port exposed\u003e : \u0026#x3C; MySQL Port running inside container\u003e\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e'3306:3306'\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e'33060:33060'\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eexpose\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# Opens port 3306 on the container\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e'3306'\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e'33060'\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# Where our data will be persisted\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e my\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003edb\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e/var/lib/mysql\n      \n  \u003cspan class=\"token comment\"\u003e# http://localhost:8080/ to log into your DB\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003eadminer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e adminer\n    \u003cspan class=\"token key atrule\"\u003erestart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e always\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e 8080\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e8080\u003c/span\u003e\n      \n\u003cspan class=\"token comment\"\u003e# Names our volume\u003c/span\u003e\n\u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  my\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003edb\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNow we can run one command to get it all running:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# build/run contains\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e up\n\n\u003cspan class=\"token comment\"\u003e# stop all containers (for ctl+c twice)\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e down\n\n\u003cspan class=\"token comment\"\u003e# Clean up everything\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e down -v --rmi all --remove-orphans\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou can connect to the container directly or connect with the mysql client or use the http://localhost:8080 to get a GUI for full access\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/database/mysql-gui.jpg\" alt=\"mysql-gui\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eMySQL SQL Statements\u003c/h2\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e Users\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  id \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ePRIMARY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eKEY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAUTO_INCREMENT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  email  \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003eNOT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eUNIQUE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  bio \u003cspan class=\"token keyword\"\u003eTEXT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  country \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e Users\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  email\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  bio\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  country\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token string\"\u003e'hello@world.com'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token string\"\u003e'I love strangers'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token string\"\u003e'US'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e Users\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e Bookings\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  id \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ePRIMARY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eKEY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAUTO_INCREMENT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  guest_id \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  room_id \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  start_date \u003cspan class=\"token keyword\"\u003edatetime\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  end_date \u003cspan class=\"token keyword\"\u003edatetime\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  price \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  total \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  created_at \u003cspan class=\"token keyword\"\u003edatetime\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e Rooms\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  owner_id \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  price \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  hot_tub \u003cspan class=\"token keyword\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  home_type \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  room_type \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  total_occupancy \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  total_bedrooms \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  total_bathrooms \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  summary \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  created_at \u003cspan class=\"token keyword\"\u003edatetime\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  updated_at \u003cspan class=\"token keyword\"\u003edatetime\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  latitude \u003cspan class=\"token keyword\"\u003eFLOAT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  longitude \u003cspan class=\"token keyword\"\u003eFLOAT\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eMySQL with Spatial Data\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eMySQL \u003ccode\u003ePOINT(lng,lat)\u003c/code\u003e, just like PostGIS maintains (lng,lat), however... the \u003ccode\u003eST_GeomFromText\u003c/code\u003e like \u003ccode\u003eST_GeomFromText('POINT(45.5051 -122.6750)', 4326)\u003c/code\u003e DOES \u003ccode\u003eLAT/LNG\u003c/code\u003e??\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThere is HUGE difference from MySQL v5.7 to v8.0\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePrior to v8 spatial data there wasn't multiple spatial reference systems and geographic computations all computations were Catesian\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSo what is the least you need to know about??\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGIS libraries use \u003ca href=\"https://epsg.io/\"\u003eEPSG\u003c/a\u003e (EPSG actually stands for \u003ccode\u003eEuropean Petroleum Survey Group\u003c/code\u003e) codes as Spatial Reference System Identifiers (SRIDs)\u003c/li\u003e\n\u003cli\u003eAll you need to know when working with spatial data on the web is most maps use the Spatial Reference System of \u003ccode\u003e4326\u003c/code\u003e which is \u003ccode\u003eWGS 84 (Google Earth is in a Geographic coordinate system)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eGeospatial data is should be stored in internal geometry format either \u003ccode\u003eWell-Known Text (WKT)\u003c/code\u003e or \u003ccode\u003eWell-Known Binary (WKB)\u003c/code\u003e format.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ePoint(X,Y)\u003c/code\u003e is a constructor for numbers with precision and does not require converting first to text making it faster.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e-- Slower\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e SOME_DB \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e coordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Portland\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_GeomFromText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POINT(45.5051 -122.6750)'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- Faster\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e SOME_DB \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e coordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Portland\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e122.6750\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.5051\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's define some points instead of 2 columns lat/long\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eplaces\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e11\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eunsigned\u003c/span\u003e \u003cspan class=\"token operator\"\u003eNOT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAUTO_INCREMENT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evarchar\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e256\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eDEFAULT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e SRID \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e \u003cspan class=\"token operator\"\u003eNOT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ePRIMARY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eKEY\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's create an idex\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINDEX\u003c/span\u003e pt_idx \u003cspan class=\"token keyword\"\u003eON\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNow let's add some points\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e the \u003ccode\u003ePOINT(LNG, LAT)\u003c/code\u003e format\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eplaces\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Portland\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e122.6795\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.52054\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eplaces\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Vancouver\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e123.1207\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e49.2827\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eplaces\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Seattle\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e122.33551\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e47.604311\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eplaces\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"San Francisco\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e122.416534\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e37.771800273\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003eplaces\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token identifier\"\u003e\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Ottawa\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e75.697174\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.42062\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSelect Data\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e  id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e  id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsGeoJSON\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCalculate distances\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e-- Distance from the montreal\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\nST_Distance_Sphere\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e73.6049652\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.503459\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e-- Distance less that 500Km (500000m) from the montreal \u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e name \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\n\u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e ST_Distance_Sphere\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ePOINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e73.6049652\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.503459\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token number\"\u003e500000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSelects all points in a polygon\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf you look closer, you’ll notice that the last point is the same as the first one and we have 5 points. This is because we need to “close” the polygon.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@polygon\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  ST_GeomFromText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POLYGON(( -125.903320 44.668, -119.22 44.668, -119.22 50.2612, -125.903320 50.2612, -125.903320 44.668))'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e  \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e ST_CONTAINS\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e@polygon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e coordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGet the result as GeoJson\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@polygon\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ST_SRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  ST_GeomFromText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POLYGON(( \u003c/span\u003e\n\u003cspan class=\"token string\"\u003e    -129.24316 43.16512263,\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e    -116.455078125 43.16512263,\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e    -116.455078125 52.24125614,\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e    -129.24316 52.24125614,\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e    -129.24316 43.165\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e  ))'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e json_merge\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"type\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"FeatureCollection\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"features\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \n    json_arrayagg\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n      json_merge\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"type\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Feature\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"properties\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e  \n          json_merge\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n            json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'name'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        json_object\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'geometry'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsGeoJSON\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecoordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \n  \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e ST_CONTAINS\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e@polygon\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e coordinates\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003ePostgres \u0026#x26; PostGIS\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eThe \u003ccode\u003epostgis/postgis\u003c/code\u003e image will have the following extensions installed:\n\u003cul\u003e\n\u003cli\u003epostgis\u003c/li\u003e\n\u003cli\u003epostgis_topology\u003c/li\u003e\n\u003cli\u003efuzzystrmatch\u003c/li\u003e\n\u003cli\u003epostgis_tiger_geocoder\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDocker stuff\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eCreate a \u003ccode\u003edocker-compose.yml\u003c/code\u003e file\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-yml\"\u003e\u003ccode class=\"language-yml\"\u003e\u003cspan class=\"token key atrule\"\u003eversion\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"3.4\"\u003c/span\u003e\n\u003cspan class=\"token key atrule\"\u003eservices\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003epgAdmin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003erestart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e always\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e dpage/pgadmin4\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"8000:80\"\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eenvironment\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003ePGADMIN_DEFAULT_EMAIL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 1234@admin.com\n      \u003cspan class=\"token key atrule\"\u003ePGADMIN_DEFAULT_PASSWORD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1234\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e pgadmin\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e/var/lib/pgadmin\n  \u003cspan class=\"token key atrule\"\u003epostgis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003erestart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e always\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e postgis/postgis\n    \u003cspan class=\"token key atrule\"\u003econtainer_name\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"postgis_container\"\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"5432:5432\"\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eenvironment\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003ePOSTGRES_USER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e me\n      \u003cspan class=\"token key atrule\"\u003ePOSTGRES_PASSWORD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1234\u003c/span\u003e\n      \u003cspan class=\"token key atrule\"\u003ePOSTGRES_DB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e letsgetspatial\n    \u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e pgvol\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e/var/lib/postgresql/data\n\u003cspan class=\"token key atrule\"\u003evolumes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003epgvol\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003epgadmin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edocker-compose\u003c/code\u003e commands:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# Stop these services\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e stop\n\n\u003cspan class=\"token comment\"\u003e# Start these services\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e start\n\n\u003cspan class=\"token comment\"\u003e# Delete these services\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e down\n\n\u003cspan class=\"token comment\"\u003e# Delete all docker volumes\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e volume prune\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eThere are 2 ways to connect to the postgresdatabase server\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003ePSQL\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eThe above \u003ccode\u003edocker-compose\u003c/code\u003e command spins up a container that has postgres/postgis/psql installed in the container\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# Connect into the container\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003edocker\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexec\u003c/span\u003e -it postgis_container \u003cspan class=\"token function\"\u003ebash\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# Connect into postgres inside your container\u003c/span\u003e\n$ psql -d letsgetspatial -U me\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003ePG Admin4\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eThe \u003ccode\u003edocker-compose\u003c/code\u003e command also spins up a container for \u003ccode\u003epgadmin4\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eTo go to \u003ccode\u003epgadmin4\u003c/code\u003e go to \u003ccode\u003ehttp://localhost:8000/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eUser name that has been defined in the \u003ccode\u003edocker-compose\u003c/code\u003e is: \u003ccode\u003e1234@admin.com\u003c/code\u003e, and the password is \u003ccode\u003e1234\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eHere you want to \u003ccode\u003eAdd new server\u003c/code\u003e Take the below JSON data to fill in the GUI\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  generalTab\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"name\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"letsgetspatial-server\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  connectionTab\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"host\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"postgis\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"port\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"5432\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"user\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"me\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"password\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"1234\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"maintenaceDatabase\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"letsgetspatial\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eYou talbles will live in \u003ccode\u003eletsgetspatial-server\u003c/code\u003e \u003e \u003ccode\u003eDatabases\u003c/code\u003e \u003e \u003ccode\u003eletsgetspatial\u003c/code\u003e \u003e \u003ccode\u003eSchemas\u003c/code\u003e \u003e \u003ccode\u003epublic\u003c/code\u003e \u003e \u003ccode\u003eTables\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003ePostgres commands\u003c/h2\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# List databases\u003c/span\u003e\n\u003cspan class=\"token assign-left variable\"\u003epostgres\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e#  \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003el\n\n\u003cspan class=\"token comment\"\u003e# Use or switch Databases\u003c/span\u003e\n\u003cspan class=\"token assign-left variable\"\u003epostgres\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e# \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003ec sales\n\n\u003cspan class=\"token comment\"\u003e# List tables\u003c/span\u003e\n\u003cspan class=\"token assign-left variable\"\u003epostgres\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e# \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003edt\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003ePostgres/PostGIS Spatial Table\u003c/h2\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e EXTENSION postgis\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e PostGIS_version\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e-- Create a table then add the spatial column\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e places \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  id \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e GENERATED \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eDEFAULT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eIDENTITY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ePRIMARY\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eKEY\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  name \u003cspan class=\"token keyword\"\u003etext\u003c/span\u003e \u003cspan class=\"token operator\"\u003eNOT\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNULL\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e AddGeometryColumn\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'places'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'geom'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'4326'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POINT'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e-- Add a spatial index (to drop the index ...`DROP INDEX places_geom_idx;`)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINDEX\u003c/span\u003e places_geom_idx \u003cspan class=\"token keyword\"\u003eON\u003c/span\u003e places \u003cspan class=\"token keyword\"\u003eUSING\u003c/span\u003e GIST \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egeom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e-- Insert some data\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e geom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Portland'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e  ST_GeomFromText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POINT(-122.6795 45.52054)'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e geom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Vancouver'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_MakePoint\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e123.1207\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e49.2827\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e geom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Seattle'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_MakePoint\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e122.33551\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e47.604311\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e geom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'San Francisco'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_MakePoint\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e122.416534\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e37.771800273\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTO\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e geom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eVALUES\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Ottawa'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_MakePoint\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e75.697174\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.42062\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e-- Get data \u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e  id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egeom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e  id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsGeoJSON\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egeom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e-- Distances\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\nST_DistanceSpheroid\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  geom\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \n  ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_MakePoint\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e73.6049652\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.503459\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token string\"\u003e'SPHEROID[\"WGS84\",6378137,298.257223563]'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \n\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e name \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places\n\u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e ST_DistanceSpheroid\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  geom\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \n  ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_MakePoint\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e73.6049652\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e45.503459\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- montreal\u003c/span\u003e\n  \u003cspan class=\"token string\"\u003e'SPHEROID[\"WGS84\",6378137,298.257223563]'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token number\"\u003e500000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \n\n\n\u003cspan class=\"token comment\"\u003e-- Tansform projections\u003c/span\u003e\nST_Transform\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eST_GeomFromText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POINT(120.08 30.96)'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2163\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e-- Points in polygon\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e  \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ST_AsText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egeom\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e places \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e ST_CONTAINS\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  ST_SetSRID\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    ST_GeomFromText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'POLYGON(( -125.903320 44.668, -119.22 44.668, -119.22 50.2612, -125.903320 50.2612, -125.903320 44.668))'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e4326\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  geom\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e====\u003c/p\u003e\n\u003ch1\u003eFirebase's Firestore\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eFirebase has 2 flavor of NoSQL Database \u003ccode\u003eRealtime Database\u003c/code\u003e \u0026#x26; \u003ccode\u003eFirestore Database\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003eRealtime Database\u003c/code\u003e as the original database before Google aquired Firebase and the \u003ccode\u003eFirestore Database\u003c/code\u003e is if the Realtime database \u0026#x26; Google had a baby.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn most cases it's probably best to user \u003ccode\u003eFirestore\u003c/code\u003e, plus \u003ccode\u003eFirestore\u003c/code\u003e allow geo points\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eA great feature of Firebase is that you can use the \u003ccode\u003eEmulator\u003c/code\u003e to test out all the Firebase services locally\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eResources\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://firebase.google.com/docs/emulator-suite\"\u003eFirebase Emulator\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://firebase.google.com/docs/firestore/query-data/get-data\"\u003eAdd/Get data from a DB\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://firebase.google.com/docs/reference/js/v8\"\u003eFirebase Reference Docs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInitialize the Firebase application\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eGo to the \u003ca href=\"https://console.firebase.google.com/\"\u003eFirebase Console\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003eCreate or select a project\u003c/li\u003e\n\u003cli\u003eGo to the \u003ccode\u003eFirestore\u003c/code\u003e tab in the sidebase and click \u003ccode\u003eCreate Database\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eInitialize your application in your terminal\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# just need to install the `firebase-tools` globally once\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e i -g firebase-tools\n\n$ firebase init\n\u003cspan class=\"token comment\"\u003e# Select firestore \u0026#x26; the emulator (you can alway add/remove later)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# You should have a `firebase.json` \u0026#x26; `.firebaserc` file\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eInstall some stuff\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e init -y\n$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e i firebase-admin\n$ \u003cspan class=\"token function\"\u003enpm\u003c/span\u003e i nodemon -D\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003eUpdate your \u003ccode\u003epackage.json\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"scripts\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"start\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nodemon src\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"local:firebase\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"firebase emulators:start --import=firebase/backup --export-on-exit=firebase/backup\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSo Firebase uses configs and a \u003ccode\u003efirebase.json\u003c/code\u003e \u0026#x26; \u003ccode\u003e.firebaserc\u003c/code\u003e file to connect your code to the project. The \u003ccode\u003efirebase.json\u003c/code\u003e file is absolutly fine to add you your source control because all the controls are done in the \u003ccode\u003efirestore.rules\u003c/code\u003e file\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExample of a \u003ccode\u003efirebase.json\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"firestore\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"rules\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"firebase/firestore.rules\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"indexes\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"firebase/firestore.indexes.json\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"emulators\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"auth\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"port\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e9099\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"firestore\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"port\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e8088\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"ui\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"enabled\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExample of a \u003ccode\u003e.firebaserc\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"projects\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"default\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u0026#x3C;YOUR_PROJECT_NAME\u003e\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhen you use the \u003ccode\u003efirebase emulators:start\u003c/code\u003e when you close the process the data do not persist in order to persist the data you have to tell it to import/export the data add \u003ccode\u003e--import=firebase/backup --export-on-exit=firebase/backup\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMake sure you have a \u003ccode\u003efirebase/firestore.rules\u003c/code\u003e, these current rules anyone to read/write to the database to don't publish this\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003erules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /{document=**} {\n      allow read, write;\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAlmost time to add data... Go to your Firebase project in the Console and click the gear icon in the navbar, \u003ccode\u003eProject settings\u003c/code\u003e \u003e \u003ccode\u003eService account\u003c/code\u003e \u003e \u003ccode\u003eGenerate new private key\u003c/code\u003e copy this key to your source code \u003cstrong\u003eMAKE SURE YOU GITIGNORE THIS FILE\u003c/strong\u003e, this file provides admin access to your application\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eAdmin verses Firestore/app\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eIf you are using firebase on the client use the \u003ccode\u003efirebase/app\u003c/code\u003e package, if you are using Fiebase on the server where you can control your Firebase credentials use \u003ccode\u003efirebase-admin\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eExmaple of initializing a Firebase connection on the client:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003efirebase\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'firebase/app'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token string\"\u003e'firebase/firestore'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003econfig\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'../config'\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Only initialize the firebase app once\u003c/span\u003e\n\u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003efirebase\u003cspan class=\"token operator\"\u003e?.\u003c/span\u003eapps\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elength\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e firebase\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003einitializeApp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003efirebase\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e db \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e firebase\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efirestore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eExmaple of initializing a Firebase connection on the server:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e admin \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"firebase-admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e serviceAccount \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"./serviceAccountKey.json\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\nadmin\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003einitializeApp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ecredential\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e admin\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecredential\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecert\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eserviceAccount\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e db \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e admin\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efirestore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eCRUD the Firestore Database\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://firebase.google.com/docs/firestore/query-data/get-data\"\u003eDocs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eAdd\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eWhen adding a document to a collection you can provide the id or you can let firebase create it for you\u003c/li\u003e\n\u003cli\u003eHere's an example of you create the document id:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// Defining the document id explicityly\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e youRef \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e db\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"you-define-ids\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nyouRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"some-document-id-001\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003emessage\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nyouRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"some-document-id-002\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003emessage\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Let firebase define the document id\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e fbRed \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e db\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"firebase-define-ids\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nfbRed\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecapital\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nfbRed\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecapital\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nfbRed\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecapital\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nfbRed\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecapital\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nfbRed\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecapital\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nfbRed\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecapital\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eRead\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eGet a specific document base of the document ID\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e docRef \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e db\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"you-define-ids\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"some-document-id-001\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ndocRef\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    doc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexists\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Document data:\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e doc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"No such document!\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error getting document:\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eQuery where a value equals something\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003edb\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"firebase-define-ids\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ewhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"capital\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"==\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003equerySnapshot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    querySnapshot\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e// doc.data() is never undefined for query doc snapshots\u003c/span\u003e\n      \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edoc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\" =\u003e \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e doc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error getting documents: \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eOther queries like \u003ccode\u003eorderBy()\u003c/code\u003e, \u003ccode\u003e.orderBy(\u0026#x3C;key\u003e, \"desc\")\u003c/code\u003e, \u003ccode\u003elimit()\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eIf you want to query all the times a user is tagged you an array value in the document\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"users\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"user2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eQuery the following users\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e usersRef \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e db\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"users\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nusersRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003efollowing\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"user2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nusersRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003efollowing\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nusersRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003efollowing\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"user2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nusersRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003efollowing\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nusersRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003efollowing\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nusersRef\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003efollowing\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user3\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\nusersRef\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ewhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"following\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"array-contains-any\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user3\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003equerySnapshot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    querySnapshot\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edoc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\" =\u003e \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e doc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error getting documents: \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eLet's make it spatial!\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eYou can do geospatial stuff with \u003ccode\u003efirestore\u003c/code\u003e because of geohashing\u003c/li\u003e\n\u003cli\u003eA geohash is a convenient way of expressing a location (anywhere in the world) using a short alphanumeric string, with greater precision obtained with longer strings.\u003c/li\u003e\n\u003cli\u003eA geohash actually identifies a rectangular cell: at each level, each extra character identifies one of 32 sub-cells.\u003c/li\u003e\n\u003cli\u003e\u003cimg src=\"/assets/blog/geo/geohash.jpg\" alt=\"geohash\"\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.movable-type.co.uk/scripts/geohash.html\"\u003eRead more on geohashes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eVancouver, BC has coordinates of 49.2827° N, 123.1207° W and the geohash would be \u003ca href=\"http://geohash.org/c2b2q7dhx\"\u003e\u003ccode\u003ec2b2q7dhx\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eUsing \u003ccode\u003egeofirestore\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://geofirestore.com/\"\u003egeofirestore docs\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAs of 09-2021 \u003ccode\u003egeofirestore\u003c/code\u003e only supports up to \u003ccode\u003efirebase\u003c/code\u003e v8\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWhen using \u003ccode\u003egeofirestore\u003c/code\u003e all you need to provide in the document is a \u003ccode\u003ecoordinates: new firebase.firestore.GeoPoint(\u0026#x3C;lat\u003e, \u0026#x3C;lng\u003e)\u003c/code\u003e property. Geofirestore will take this GeoPoint and create a geohash from it\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e you can still query your collection with the regular Friebase querys however you now have the option to do some limited spatial queries\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSetup\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// Firebase v8\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e/*\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003eimport firebase from 'firebase/app';\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003eimport 'firebase/firestore';\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003eimport * as geofirestore from 'geofirestore';\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e*/\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// *NOTE: Firebase v9 ( Currently geofirebase library only works with the Firebase Compat library. Support for the Firebase Modular library is coming down the road.)\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003efirebase\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'firebase/compat/app'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token string\"\u003e'firebase/compat/firestore'\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e geofirestore\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'geofirestore'\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Initialize the Firebase SDK\u003c/span\u003e\nfirebase\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003einitializeApp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Create a Firestore reference\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e firestore \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e firebase\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efirestore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Create a GeoFirestore reference\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eGeoFirestore\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e geofirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003einitializeApp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efirestore\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Create a GeoCollection reference\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e geocollection \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eGeoFirestore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'restaurants'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAdd a point to the collection\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// Add a document to the collection containing `coordinates` key\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e uuid \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003euuidv4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ngeocollection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edoc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euuid\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ecoordinates\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003efirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGeoPoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e42.3547255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e71.0549425\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// YOU NEED THIS LINE\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003egeojson\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Feature\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003egeometry\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Point\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ecoordinates\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e71.0549425\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e42.3547255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eproperties\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      uuid\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003euid\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user1_000\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// This allows you to filter by multiple users\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ename\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Starbucks\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eaddress\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"211 Congress St,Boston, MA 02210\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003erating\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e3.5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eimage\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"https://s3-media4.fl.yelpcdn.com/bphoto/AVDfFF1OaqiNDqeg-Z2xEQ/o.jpg\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eQuery the collection\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003efindNearest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003epoint\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e radiusInKm\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e limit \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Create a GeoQuery based on a location\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e center \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003efirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGeoPoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epoint\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e point\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elng\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// perform the query\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e query \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e geocollection\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003enear\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e center\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eradius\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e radiusInKm \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e//\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ewhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"geojson.properties.uid\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"array-contains-any\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e users\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elimit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elimit\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e value \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e query\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// Cleanup the data\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e results \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003edocs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e data \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e geojson\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e g \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003edata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003egeojson\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eproperties\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003egeojson\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eproperties\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003egeohash\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e g\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003egeohash\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"[length]\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e results\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elength\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e results\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003efindNearest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003elat\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e42.3461\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003elng\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e71.0974\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"user3_000\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"user1_000\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eQuery nearest \u0026#x26; property value\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e geocollection\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e GeoCollectionReference \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e geofirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Users'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e centerCoords \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e lat\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e42.3461\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e lng\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e71.0974\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e geoQuery \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e geocollection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003enear\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    center\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003efirebase\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirestore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eGeoPoint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecenterCoords\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elat\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003ecenterCoords\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elng\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    radius\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e10.5\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ewhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'type'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'=='\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'coffee'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e====\u003c/p\u003e\n\u003ch1\u003eDynamoDB\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Operations_Amazon_DynamoDB.html\"\u003eDynamoDB API Reference\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB.html\"\u003eDynamoDB Class list\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eDynamoDB is a hosted NoSQL database offered by Amazon Web Services (AWS). It offers:\n\u003cul\u003e\n\u003cli\u003eReliable performance even as it scales;\u003c/li\u003e\n\u003cli\u003eManaged experience, so you won't be SSH-ing into servers to upgrade the crypto libraries;\u003c/li\u003e\n\u003cli\u003eSmall, simple API allowing for simple key-value access as well as more advanced query patterns.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIt works extremely well with Serverless applications (API Gateway \u0026#x26; Lambda functions)\u003c/li\u003e\n\u003cli\u003eDynamodb you work with \u003ccode\u003etables\u003c/code\u003e, \u003ccode\u003eattributes\u003c/code\u003e, \u0026#x26; \u003ccode\u003eitems\u003c/code\u003e. Each table needs to have a \u003ccode\u003ePrimary Key\u003c/code\u003e which is a special attribute that is unique or a \u003ccode\u003ePrimary Key + Sort Key\u003c/code\u003e aka \u003ccode\u003eComposite Primary Key\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePrimary Key\u003c/code\u003e or \u003ccode\u003ePartition Key\u003c/code\u003eis just that, a unique attribute to which you can query on it also allows\u003c/li\u003e\n\u003cli\u003eThe  \u003ccode\u003ePrimary Key + Sort Key\u003c/code\u003e is a combination of 2 attributes when used together makes a unique identificator. It allows for id flexibility\u003c/li\u003e\n\u003cli\u003eIn addition to \u003ccode\u003eprimary key\u003c/code\u003e there's also \u003ccode\u003eSecondary Indexes\u003c/code\u003e where that allows you to query the table data with an alternate key. There are 2 kinds of secondary indexes:\n\u003cul\u003e\n\u003cli\u003eGlobal Secondary Index: another index partion \u0026#x26; sort keys that differ from the primary \u0026#x26; sort key\u003c/li\u003e\n\u003cli\u003eLocal Secondary Index: similar partition key but different sort key\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eThe basic Dynamodb API consist of:\n\u003cul\u003e\n\u003cli\u003ePutItem (Create)\u003c/li\u003e\n\u003cli\u003eBatchWriteItem (Create)\u003c/li\u003e\n\u003cli\u003eGetItem (Read)\u003c/li\u003e\n\u003cli\u003eBatchGetItem (Read)\u003c/li\u003e\n\u003cli\u003eQuery (Read)\u003c/li\u003e\n\u003cli\u003eScan (Read)\u003c/li\u003e\n\u003cli\u003eUpdateItem (Update)\u003c/li\u003e\n\u003cli\u003eDeleteItem (Delete)\u003c/li\u003e\n\u003cli\u003eBatchWriteItem (Delete)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGlobal tables\u003c/code\u003e provide a solution for deploying a multi-region, multi-master database, without having to build and maintain your own replication solution.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTime To Live (TTL)\u003c/code\u003e, allows you to define when items in a table expire so that they can be automatically deleted from the database.\u003c/li\u003e\n\u003cli\u003eWhen you create a table in DynamoDB you need to specify the throughput capacity for read/write capacity unit\n\u003cul\u003e\n\u003cli\u003eOne read capacity unit represents one strongly consistent read per second, for an item up to 4 KB in size.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhen reading the data in the database you can do \u003ccode\u003escan\u003c/code\u003e or \u003ccode\u003equeries\u003c/code\u003e. A Scan operation reads every item in a table or a secondary index. By default, a Scan operation returns all of the data attributes for every item in the table or index.\u003c/li\u003e\n\u003cli\u003eYou can also encrypt the data in the database\u003c/li\u003e\n\u003cli\u003eYou can also add automated tools for monitoring with CloudWatch Alarms, Logs, Events\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eAnatomy of an Item\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWhen setting an attribute for a DynamoDB item, you must specify the Data Type (Scalar, Documents, \u0026#x26; Sets) of the attribute.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_AttributeValue.html\"\u003eAWS Dynamodb API Attribute Values\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eData Types:\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eScalar\u003c/strong\u003e Data Types:\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eNumbers\u003c/code\u003e (N) − They are limited to 38 digits, and are either positive, negative, or zero.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eString\u003c/code\u003e (S) − They are Unicode using UTF-8, with a minimum length of \u003e0 and maximum of 400KB.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eBinary\u003c/code\u003e (B) − They store any binary data, e.g., encrypted data, images, and compressed text. DynamoDB views its bytes as unsigned.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eBoolean\u003c/code\u003e (BOOL) − They store true or false.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eNull\u003c/code\u003e (NULL) − They represent an unknown or undefined state.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDocument\u003c/strong\u003e Data Types:\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eList\u003c/code\u003e (L) − It stores ordered value collections, and uses square ([...]) brackets.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMap\u003c/code\u003e (M) − It stores unordered name-value pair collections, and uses curly ({...}) braces.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSet\u003c/strong\u003e Data Type:\n\u003cul\u003e\n\u003cli\u003eAvailable Attribute values: B(S|NS|SS)\u003c/li\u003e\n\u003cli\u003eMust contain elements of the same type whether number, string, or binary. The only limits placed on sets consist of the 400KB item size limit, and each element being unique.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eHere's an example of the Data Types:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003e{\n    \"Name\": { \"S\": \"Alex DeBrie\" },\n    \"Age\": { \"N\": \"29\" },\n    \"Roles\": { \"L\": [{ \"S\": \"Admin\" }, { \"S\": \"User\" }] }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eWhen creating a new table you need: [\u003ccode\u003eAttributeDefinitions\u003c/code\u003e, \u003ccode\u003eKeySchema\u003c/code\u003e, \u003ccode\u003eProvisionedThroughput\u003c/code\u003e, \u003ccode\u003eTableName\u003c/code\u003e, \u0026#x26; \u003ccode\u003eStreamSpecification\u003c/code\u003e]\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDefining a table's\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.CreateTable.html\"\u003eAWS Docs example on how to CRUD a table\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-dynamodb/index.html\"\u003eNode.js \u003ccode\u003e@aws-sdk/client-dynamodb\u003c/code\u003e reference\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eWhen creating a new table you need to define the primary key (partion and/or sort key)\u003c/li\u003e\n\u003cli\u003eEvery item in a table is uniquely identified by its primary key.\u003c/li\u003e\n\u003cli\u003eKey schema: (HASH|RANGE) (Partition|Sort key)\n\u003cimg src=\"/assets/blog/database/aws-table-hash-range.png\" alt=\"\"\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eHASH\u003c/code\u003e is for you primary key and \u003ccode\u003eRANGE\u003c/code\u003e is for when you use a composity key\u003c/li\u003e\n\u003cli\u003eYou can create a data and it's configuration via the AWS Console, aws-cli, or with code\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eLocal development\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eYou can run DynamoDB locally with \u003ca href=\"https://hub.docker.com/r/amazon/dynamodb-local/\"\u003eAWS official docker container\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou will also need the \u003ca href=\"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html\"\u003eAWS CLI\u003c/a\u003e installed on your computer\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSetup your aws config add this to your \u003ccode\u003e~/.aws/credentials\u003c/code\u003e file:\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003elocal-dev\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\naws_access_key_id \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fakeMyKeyId\naws_secret_access_key \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e fakeSecretAccessKey\nregion \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ap-southeast-2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eThis will allows us to pick the profile we want for local development\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/cli/latest/reference/dynamodb/index.html\"\u003eDynamoDB AWS CLI commands here\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/workbench.html\"\u003eNoSQL Workbench\u003c/a\u003e for Amazon DynamoDB\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a \u003ccode\u003edocker-compose.yml\u003c/code\u003e file (In order to make this local-dynamodb work with NoSQL Workbench you have to provide the \u003ccode\u003e-sharedDb\u003c/code\u003e flag). \u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.UsageNotes.html\"\u003eMore on the shared flag here\u003c/a\u003e or \u003ca href=\"https://stackoverflow.com/questions/63835658/can-not-find-table-using-nosql-workbench-for-dynamodb-when-connecting-to-dynamod\"\u003estackoverflow\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-yml\"\u003e\u003ccode class=\"language-yml\"\u003e\u003cspan class=\"token key atrule\"\u003eversion\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'3'\u003c/span\u003e\n\u003cspan class=\"token key atrule\"\u003eservices\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token key atrule\"\u003elocal-dynamo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token key atrule\"\u003eimage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e amazon/dynamodb\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003elocal\n    \u003cspan class=\"token key atrule\"\u003ecommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003ejar DynamoDBLocal.jar \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003esharedDb \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003edbPath .\n    \u003cspan class=\"token key atrule\"\u003econtainer_name\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e dynamodb\u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003elocal\n    \u003cspan class=\"token key atrule\"\u003eports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"8000:8000\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRun the local database!\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003edocker-compose\u003c/span\u003e up\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a table with the Terminal\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token comment\"\u003e# Create the DynamoDB table. (make sure to pass in the `--profile`)\u003c/span\u003e\n$ aws dynamodb create-table \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n    --profile local-dev \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n    --table-name WeatherForecast \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n    --attribute-definitions \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eCity,AttributeType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eS \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eDate,AttributeType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eS \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n    --key-schema \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eCity,KeyType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eHASH \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eDate,KeyType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eRANGE \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n    --provisioned-throughput \u003cspan class=\"token assign-left variable\"\u003eReadCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e,WriteCapacityUnits\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n    --endpoint-url http://localhost:8000\n\n\u003cspan class=\"token comment\"\u003e# list all the tables \u003c/span\u003e\n$ aws dynamodb list-tables --profile local-dev --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNoSQL Workbench Steps:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreate a DB connection\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eOperation builder\u003c/code\u003e \u003e \u003ccode\u003e+ Add connection\u003c/code\u003e \u003e \u003ccode\u003eDynamoDB local\u003c/code\u003e \u003e provide connection name \u0026#x26; port\n\u003cimg src=\"/assets/blog/database/aws-workbench-db-connection.jpg\" alt=\"aws-workbench-db-connection\"\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/database/aws-workbench-local-dynamodb-setup-active-connection.jpg\" alt=\"aws-workbench-local-dynamodb-setup-active-connection\"\u003e\n\u003cimg src=\"/assets/blog/database/aws-workbench-local-dynamodb-active-connection.jpg\" alt=\"aws-workbench-local-dynamodb-active-connection\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNow you can use the \"Data Modeler\" to create a model the\n\u003cimg src=\"/assets/blog/database/aws-workbench-create-table.jpg\" alt=\"aws-workbench-create-table\"\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDifferent ways to create a Dynamodb Table\u003c/h2\u003e\n\u003ch3\u003eCreate a Dynamodb table using \u003ccode\u003eaws-cli\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"/assets/blog/database/aws-console-dynamo.jpg\" alt=\"aws-console-dynamo\"\u003e\u003c/p\u003e\n\u003ch3\u003eCreate a Dynamodb table using \u003ccode\u003eaws-cli\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eHere's an exmaple using the \u003ccode\u003eaws-cli\u003c/code\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token assign-left variable\"\u003eDYNAMODB_TABLE_NAME\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"TableWithPartionAndSortKey\"\u003c/span\u003e\n$ \u003cspan class=\"token assign-left variable\"\u003eAWS_PROFILE\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"local-dev\"\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# Just a partion-key\u003c/span\u003e\n$ aws dynamodb create-table \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --profile \u003cspan class=\"token variable\"\u003e$AWS_PROFILE\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --table-name \u003cspan class=\"token variable\"\u003e$DYNAMODB_TABLE_NAME\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --attribute-definitions \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n          \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etitle,AttributeType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eS \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --key-schema \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etitle,KeyType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eHASH \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --provisioned-throughput \u003cspan class=\"token assign-left variable\"\u003eReadCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e,WriteCapacityUnits\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --endpoint-url http://localhost:8000\n\n\u003cspan class=\"token comment\"\u003e# If you want to use partition \u0026#x26; sort key\u003c/span\u003e\n$ aws dynamodb create-table \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --profile \u003cspan class=\"token variable\"\u003e$AWS_PROFILE\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --table-name \u003cspan class=\"token variable\"\u003e$DYNAMODB_TABLE_NAME\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --attribute-definitions \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n          \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etitle,AttributeType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eS \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n          \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003edate,AttributeType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eS \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --key-schema \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etitle,KeyType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eHASH \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"token assign-left variable\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003edate,KeyType\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eRANGE \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --provisioned-throughput \u003cspan class=\"token assign-left variable\"\u003eReadCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e,WriteCapacityUnits\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\n      --endpoint-url http://localhost:8000\n$ aws dynamodb list-tables --profile local-dev --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eCreate a Dynamodb with NoSQL Workbench\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eYou can connect and use the stand-alone \u003ca href=\"https://www.amazonaws.cn/en/dynamodb/nosql-workbench/\"\u003eNoSQL Workbench\u003c/a\u003e application to add/edit/delete tables in multiple accounts\n\u003cimg src=\"/assets/blog/database/aws-nosql-workbench.jpg\" alt=\"aws-nosql-workbench\"\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eCreate a Dynamodb table using javascript\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eNOTE:\u003c/em\u003e \u003ccode\u003eaws-sdk\u003c/code\u003e is the v2 (~62 MB) (2022-09-11 ~9,816,781 weekly downloads) is was most people current used. v3 \u003ccode\u003e@aws-sdk/client-dynamodb\u003c/code\u003e (~4.5 MB)(2022-09-11 ~471,785 weekly downloads, not really a fair comparison but just wanted to give you a scale) which is more modular which will decrease package size and increase performance. Along with the client package you will want to use \u003ccode\u003e@aws-sdk/lib-dynamodb\u003c/code\u003e to do all the CRUD opperations on your table.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's CRUD a Dynamodb table with the \u003ccode\u003ev2\u003c/code\u003e version \u003ccode\u003eaws-sdk\u003c/code\u003e. \u003cem\u003eNote:\u003c/em\u003e \u003ccode\u003eaws-sdk\u003c/code\u003e also works with ESM modules.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eInit a project\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e init\n$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e aws-sdk dotenv\n$ \u003cspan class=\"token function\"\u003emkdir\u003c/span\u003e src\n$ \u003cspan class=\"token function\"\u003etouch\u003c/span\u003e src/index.js src/db.js src/config.js .env\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003ccode\u003e.env\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003eAWS_ACCESS_KEY \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"fakeMyKeyId\"\u003c/span\u003e\nAWS_SECRET_KEY \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"fakeSecretAccessKey\"\u003c/span\u003e\nAWS_REGION \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"local\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003ccode\u003e./src/config.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"dotenv\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e config \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eaws\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003econfig\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eregion\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eenv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eAWS_REGION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ecredentials\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003eaccessKeyId\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eenv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eAWS_ACCESS_KEY\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003esecretAccessKey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eenv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eAWS_SECRET_KEY\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eendpoint\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"http://localhost:8000\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nmodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e config\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e\u003ccode\u003e./src/db.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eAWS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"aws-sdk\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e config \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"./config.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token constant\"\u003eAWS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eupdate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eaws\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eAWS\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Movies\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateTable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eKeySchema\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"title\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eKeyType\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"HASH\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Only using partition-key\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eAttributeDefinitions\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"title\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eAttributeType\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"S\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eProvisionedThroughput\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eReadCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eWriteCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateTable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eerr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Unable to create table\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Created table\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eaddMovie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rtScore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eItem\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eS\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ertScore\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eN\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e rtScore \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eputItem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eAdded \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etitle\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" with a Rotten Tomatoes Score of \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ertScore\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e%\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Unable to add movie\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egetAllMovies\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003escan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eItems\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eitem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token constant\"\u003eAWS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eConverter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eunmarshall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egetMovie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eKey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eS\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetItem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token constant\"\u003eAWS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eConverter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eunmarshall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eItem\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eupdateMovieScore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e newRtScore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eItem\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eS\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ertScore\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eN\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e newRtScore\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eputItem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eUpdated \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etitle\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" with a Rotten Tomatoes Score of \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003enewRtScore\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e%\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Unable to update movie\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edeleteMovie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eKey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token constant\"\u003eS\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003edeleteItem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eDeleted \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etitle\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Unable to find movie\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\nmodule\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eexports\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  createTable\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  addMovie\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  getAllMovies\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  getMovie\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  updateMovieScore\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  deleteMovie\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003eRun some commands\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a table\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").createTable()'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCRUD the table\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").addMovie(\"The Fast and the Furious\", \"100\")'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").getAllMovies()'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").updateMovieScore(\"The Fast and the Furious\", 53)'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").getMovie(\"The Fast and the Furious\")'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").deleteMovie(\"The Fast and the Furious\")'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'require(\"./src/db.js\").getAllMovies()'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's create a table with v3\u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.CreateTable.html\"\u003eaws docs example\u003c/a\u003e:\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eNOTE:\u003c/em\u003e when working with the v3 version you don't have to use DynamoDB Object for the \u003ccode\u003eItem\u003c/code\u003e property for the params, just work with regular JSON\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eNOTE:\u003c/em\u003e Below example uses aws \u003ccode\u003eprofile\u003c/code\u003e instead of \u003ccode\u003ecredentials.accessKeyId\u003c/code\u003e \u0026#x26; \u003ccode\u003ecredentials.AWS_ACCESS_KEY\u003c/code\u003e but profile will also work\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLet's CRUD a Dynamodb table with the \u003ccode\u003ev3\u003c/code\u003e version \u003ccode\u003e@aws-sdk/lib-dynamodb\u003c/code\u003e.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eInit a project\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e init\n$ \u003cspan class=\"token function\"\u003eyarn\u003c/span\u003e \u003cspan class=\"token function\"\u003eadd\u003c/span\u003e @aws-sdk/client-dynamodb @aws-sdk/lib-dynamodb dotenv\n$ \u003cspan class=\"token function\"\u003emkdir\u003c/span\u003e src\n$ \u003cspan class=\"token function\"\u003etouch\u003c/span\u003e src/index.js src/db.js src/config.js .env\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003ccode\u003e.env\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e\u003cspan class=\"token assign-left variable\"\u003eAWS_PROFILE\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"local-dev\"\u003c/span\u003e\nAWS_REGION \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"local\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003ccode\u003e./src/config.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e dotenv\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"dotenv\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ndotenv\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e config \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eaws\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003econfig\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eprofile\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eenv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eAWS_PROFILE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eregion\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eenv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eAWS_REGION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eendpoint\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"http://localhost:8000\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e config\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003ccode\u003esrc/db.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDBClient\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eCreateTableCommand\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"@aws-sdk/client-dynamodb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003ePutCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eGetCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eScanCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eQueryCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDeleteCommand\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"@aws-sdk/lib-dynamodb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003econfig\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./config.js\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"MoviesV3\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eDynamoDBClient\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eaws\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003ecreateTable\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eKeySchema\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"title\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eKeyType\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"HASH\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Only using partition-key\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eAttributeDefinitions\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eAttributeName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"title\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003eAttributeType\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"S\"\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eProvisionedThroughput\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eReadCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eWriteCapacityUnits\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eStreamSpecification\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eStreamEnabled\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCreateTableCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Table Created\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eaddMovie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rtScore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Don't pass in Dynamodb Object, pass in JSON\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eItem\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ertScore\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e rtScore\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePutCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eAdded \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etitle\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" with a Rotten Tomatoes Score of \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ertScore\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e%\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Unable to add movie\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egetAllMovies\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eScanCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Success :\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eItems\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egetMovie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eKey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eGetCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Success :\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eItem\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eupdateMovieScore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rtScore\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eItem\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ertScore\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e rtScore\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePutCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eUpdated \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etitle\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" with a Rotten Tomatoes Score of \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ertScore\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e%\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Unable to update movie\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edeleteMovie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e params \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eTableName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token constant\"\u003eTABLE_NAME\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eKey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamoDB\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eDeleteCommand\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Successfully deleted :\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e title\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e err\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003eCRUD the DB\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.createTable())'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.addMovie(\"The Fast and the Furious\", 100));'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.getAllMovies())'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.getMovie(\"The Fast and the Furious\"))'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.updateMovieScore(\"The Fast and the Furious\", 53))'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.getMovie(\"The Fast and the Furious\"))'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.deleteMovie(\"The Fast and the Furious\"))'\u003c/span\u003e\n$ \u003cspan class=\"token function\"\u003enode\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'import(\"./src/db.js\").then(db =\u003e db.getAllMovies())'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eQuery the database\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html\"\u003eDynamodb Query Docs\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAll the Dynamodb functions above have been done with the exact partition key, you can query the data in the database especially if you use the \u003ccode\u003eSort-key\u003c/code\u003e. If you are using the sort-key you can preform stronger queries on that key like greater/less-than/between/begins-with\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eValid equality test for \u003ccode\u003epartition-key\u003c/code\u003e only:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003epartitionKeyName = :partitionkeyval\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eValid \u003ccode\u003ePartition-key\u003c/code\u003e \u0026#x26; \u003ccode\u003eSort-key\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003epartitionKeyName = :partitionkeyval AND sortKeyName = :sortkeyval\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eValid comparisons for the sort key condition are as follows:\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-html\"\u003e\u003ccode class=\"language-html\"\u003esortKeyName = :sortkeyva\nsortKeyName \u0026#x3C; :sortkeyva\nsortKeyName \u0026#x3C;= :sortkeyval \nsortKeyName \u003e :sortkeyva\nsortKeyName \u003e= :sortkeyval\nsortKeyName BETWEEN :sortkeyval1 AND :sortkeyval2 \nbegins_with ( sortKeyName, :sortkeyval )\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003ebatch load a json file\u003c/h2\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-shell\"\u003e\u003ccode class=\"language-shell\"\u003e$ aws dynamodb batch-write-item --request-items file://my-data-seed.json --profile local-dev\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2\u003eSingle table design\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eYou can create a single table design using a primary key with a specific pattern.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e\u003c/h3\u003e\n","ogImage":{"url":"/assets/covers/database.jpg"},"coverImage":"/assets/covers/database.jpg"}},"__N_SSG":true},"page":"/learn/[slug]","query":{"slug":"databases"},"buildId":"F_4jQJj_eSRzbufUlGt55","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>